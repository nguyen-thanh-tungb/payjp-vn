<!DOCTYPE html>
<!-- saved from url=(0034)https://pay.jp/docs/api/#????????? -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>PAY.JP API リファレンス</title>

    <link rel="shortcut icon" href="https://pay.jp/docs/api/images/favicon.ico" type="image/x-icon">
    <link href="./api_files/screen.css" rel="stylesheet" type="text/css" media="screen">
    <link href="./api_files/print.css" rel="stylesheet" type="text/css" media="print">
    <script src="./api_files/jquery.min.js"></script>
    <link href="./api_files/css" rel="stylesheet" type="text/css">
      <script src="./api_files/all_nosearch.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["shell","python","ruby","php","javascript","java"]);
        });
      </script>
  <style id="style-1-cropbar-clipper">/* Copyright 2014 Evernote Corporation. All rights reserved. */
.en-markup-crop-options {
    top: 18px !important;
    left: 50% !important;
    margin-left: -100px !important;
    width: 200px !important;
    border: 2px rgba(255,255,255,.38) solid !important;
    border-radius: 4px !important;
}

.en-markup-crop-options div div:first-of-type {
    margin-left: 0px !important;
}
</style></head>

  <body class="index">
    <a href="https://pay.jp/docs/api/#" id="nav-button">
      <span>
        NAV
        <img src="./api_files/navbar.png">
      </span>
    </a>
    <div class="tocify-wrapper">
      <a href="https://pay.jp/" class="logo"><img class="logo" src="./api_files/logo.png"></a>
        <div class="lang-selector">
              <a href="https://pay.jp/docs/api/#" data-language-name="shell">curl</a>
              <a href="https://pay.jp/docs/api/#" data-language-name="python">Python</a>
              <a href="https://pay.jp/docs/api/#" data-language-name="ruby" class="active">Ruby</a>
              <a href="https://pay.jp/docs/api/#" data-language-name="php">PHP</a>
              <a href="https://pay.jp/docs/api/#" data-language-name="javascript">node</a>
              <a href="https://pay.jp/docs/api/#" data-language-name="java">Java</a>
        </div>
      <div id="toc" class="tocify">
      <ul id="tocify-header0" class="tocify-header"><li class="tocify-item" data-unique="introduction" style="cursor: pointer;"><a>Introduction</a></li><ul class="tocify-subheader" data-tag="2" style=""><li class="tocify-item" data-unique="認証"><a>認証</a></li><li class="tocify-item" data-unique="プロトコル"><a>プロトコル</a></li><li class="tocify-item" data-unique="メソッド"><a>メソッド</a></li><li class="tocify-item" data-unique="レスポンス形式"><a>レスポンス形式</a></li><li class="tocify-item" data-unique="タイムスタンプ"><a>タイムスタンプ</a></li></ul></ul><ul id="tocify-header1" class="tocify-header"><li class="tocify-item" data-unique="error" style="cursor: pointer;"><a>Error</a></li><ul class="tocify-subheader" data-tag="2" style=""><li class="tocify-item" data-unique="エラーハンドリング"><a>エラーハンドリング</a></li></ul></ul><ul id="tocify-header2" class="tocify-header"><li class="tocify-item" data-unique="pagination" style="cursor: pointer;"><a>Pagination</a></li></ul><ul id="tocify-header3" class="tocify-header"><li class="tocify-item" data-unique="metadata"><a>Metadata</a></li></ul><ul id="tocify-header4" class="tocify-header"><li class="tocify-item" data-unique="charge-支払い" style="cursor: pointer;"><a>Charge (支払い)</a></li><ul class="tocify-subheader" data-tag="2" style=""><li class="tocify-item" data-unique="支払いを作成"><a>支払いを作成</a></li><li class="tocify-item" data-unique="支払いを情報を取得"><a>支払いを情報を取得</a></li><li class="tocify-item" data-unique="支払い情報を更新"><a>支払い情報を更新</a></li><li class="tocify-item" data-unique="返金する"><a>返金する</a></li><li class="tocify-item" data-unique="支払い処理を確定する"><a>支払い処理を確定する</a></li><li class="tocify-item" data-unique="支払いリストを取得"><a>支払いリストを取得</a></li></ul></ul><ul id="tocify-header5" class="tocify-header"><li class="tocify-item" data-unique="customer-顧客" style="cursor: pointer;"><a>Customer (顧客)</a></li><ul class="tocify-subheader" data-tag="2" style=""><li class="tocify-item" data-unique="顧客を作成"><a>顧客を作成</a></li><li class="tocify-item" data-unique="顧客情報を取得"><a>顧客情報を取得</a></li><li class="tocify-item" data-unique="顧客情報を更新"><a>顧客情報を更新</a></li><li class="tocify-item" data-unique="顧客を削除"><a>顧客を削除</a></li><li class="tocify-item" data-unique="顧客リストを取得"><a>顧客リストを取得</a></li><li class="tocify-item" data-unique="顧客のカードを作成"><a>顧客のカードを作成</a></li><li class="tocify-item" data-unique="顧客のカード情報を取得"><a>顧客のカード情報を取得</a></li><li class="tocify-item" data-unique="顧客のカードを更新"><a>顧客のカードを更新</a></li><li class="tocify-item" data-unique="顧客のカードを削除"><a>顧客のカードを削除</a></li><li class="tocify-item" data-unique="顧客のカードリストを取得"><a>顧客のカードリストを取得</a></li><li class="tocify-item" data-unique="顧客の定期課金情報を取得"><a>顧客の定期課金情報を取得</a></li><li class="tocify-item" data-unique="顧客の定期課金リストを取得"><a>顧客の定期課金リストを取得</a></li></ul></ul><ul id="tocify-header6" class="tocify-header"><li class="tocify-item" data-unique="plan-プラン" style="cursor: pointer;"><a>Plan (プラン)</a></li><ul class="tocify-subheader" data-tag="2" style=""><li class="tocify-item" data-unique="プランを作成"><a>プランを作成</a></li><li class="tocify-item" data-unique="プラン情報を取得"><a>プラン情報を取得</a></li><li class="tocify-item" data-unique="プランを更新"><a>プランを更新</a></li><li class="tocify-item" data-unique="プランを削除"><a>プランを削除</a></li><li class="tocify-item" data-unique="プランリストを取得"><a>プランリストを取得</a></li></ul></ul><ul id="tocify-header7" class="tocify-header"><li class="tocify-item" data-unique="subscription-定期課金" style="cursor: pointer;"><a>Subscription (定期課金)</a></li><ul class="tocify-subheader" data-tag="2" style=""><li class="tocify-item" data-unique="定期課金を作成"><a>定期課金を作成</a></li><li class="tocify-item" data-unique="定期課金情報を取得"><a>定期課金情報を取得</a></li><li class="tocify-item" data-unique="定期課金を更新"><a>定期課金を更新</a></li><li class="tocify-item" data-unique="定期課金を停止"><a>定期課金を停止</a></li><li class="tocify-item" data-unique="定期課金を再開"><a>定期課金を再開</a></li><li class="tocify-item" data-unique="定期課金をキャンセル"><a>定期課金をキャンセル</a></li><li class="tocify-item" data-unique="定期課金を削除"><a>定期課金を削除</a></li><li class="tocify-item" data-unique="定期課金のリストを取得"><a>定期課金のリストを取得</a></li></ul></ul><ul id="tocify-header8" class="tocify-header"><li class="tocify-item" data-unique="token-トークン" style="cursor: pointer;"><a>Token (トークン)</a></li><ul class="tocify-subheader" data-tag="2" style="display: block;"><li class="tocify-item" data-unique="トークンを作成"><a>Tạo token</a></li><li class="tocify-item tocify-focus" data-unique="トークン情報を取得"><a>Thu thập thông tin token</a></li></ul></ul><ul id="tocify-header9" class="tocify-header"><li class="tocify-item" data-unique="transfer-入金" style="cursor: pointer;"><a>Transfer (入金)</a></li><ul class="tocify-subheader" data-tag="2" style="display: none;"><li class="tocify-item" data-unique="入金情報を取得"><a>Thu thập thông tin transfer</a></li><li class="tocify-item" data-unique="入金リストを取得"><a>Thu thập danh sách transfer</a></li><li class="tocify-item" data-unique="Thu thập các mục khi transfer"><a>入金の内訳を取得</a></li></ul></ul><ul id="tocify-header10" class="tocify-header"><li class="tocify-item" data-unique="event-イベント"><a>Event (イベント)</a></li><ul class="tocify-subheader" data-tag="2" style="display: none;"><li class="tocify-item" data-unique="イベント情報を取得"><a>イベント情報を取得</a></li><li class="tocify-item" data-unique="イベントリストを取得"><a>イベントリストを取得</a></li></ul></ul><ul id="tocify-header11" class="tocify-header"><li class="tocify-item" data-unique="account-アカウント"><a>Account (アカウント)</a></li><ul class="tocify-subheader" data-tag="2" style=""><li class="tocify-item" data-unique="アカウント情報を取得"><a>Thu thập thông tin của account</a></li></ul></ul></div>
        <ul class="toc-footer">
            <li><a href="https://pay.jp/">Sign Up for PAY.JP</a></li>
            <li><a href="http://github.com/tripit/slate">Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <div name="introduction" data-unique="introduction"></div><h1 id="introduction">Introduction</h1>

<p>PAY.JPは、RESTをベースに構成された決済APIです。都度の支払い、定期的な支払い、顧客情報の管理など、ビジネス運用における様々なことができます。</p>

<div name="認証" data-unique="認証"></div><h2 id="認証">認証</h2>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/charges <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s2">"payjp"</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s2">"sk_test_c62fade9d045b54cd76d7036"</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036")
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apikey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
</code></pre>

<p>PAY.JPのAPIを利用するには、ユーザー登録を行い、APIキーを取得してください。
テスト用のキーでは、本番の支払い処理を行うサーバーへは接続されず、実際の支払い情報として計上されることもありません。本番用のキーは、本番申請を行うことで利用できるようになります。</p>

<table><thead>
<tr>
<th>種類</th>
<th>用途</th>
</tr>
</thead><tbody>
<tr>
<td>パブリックキー</td>
<td>HTML内に埋め込むトークン生成用のパブリックキー</td>
</tr>
<tr>
<td>シークレットキー</td>
<td>サーバー側からBasic認証のユーザーネームとして渡すシークレットキー</td>
</tr>
</tbody></table>

<p>通常の認証は、シークレットキーをユーザーネームとして扱い、Basic認証経由で行われます。パブリックキーは、あなたの決済画面のHTML内に組み込む公開用のAPIキーで、クレジットカードのトークンを生成する際に使用します。
シークレットキーは、全てのAPIリクエスト操作が可能となる重要なキーなので、くれぐれ
も取扱いにご注意ください。</p>

<div name="プロトコル" data-unique="プロトコル"></div><h2 id="プロトコル">プロトコル</h2>

<p>セキュリティのため、PAY.JPに対する全てのAPI通信は必ずHTTPSで行うようにしてください。</p>

<div name="メソッド" data-unique="メソッド"></div><h2 id="メソッド">メソッド</h2>

<p>PAY.JP APIへのリクエストでは、GET、POST、DELETEの3種類のHTTPメソッドを利用できます。</p>

<div name="レスポンス形式" data-unique="レスポンス形式"></div><h2 id="レスポンス形式">レスポンス形式</h2>

<p>APIからのレスポンスデータは全てJSON形式で返されます。</p>

<div name="タイムスタンプ" data-unique="タイムスタンプ"></div><h2 id="タイムスタンプ">タイムスタンプ</h2>

<p>日次に関するデータは、UTCタイムゾーンのUNIXタイムスタンプで表示されます。一部入金予定日や入金実行日など秒数の関係ないものは、Date型(e.g. 2015-09-07) で表示されます。</p>

          <div name="error" data-unique="error"></div><h1 id="error">Error</h1>

<p>エラーとなるリクエストには、"error"というキーが含まれたエラーレスポンスが返されます。
ステータスコードには、4xxか5xxの該当するエラーのステータスコードがセットされます。通常の成功するレスポンスでは、ステータスコードには200のステータスコードがセットされます。</p>

<table><thead>
<tr>
<th>タイプ</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>client_error</td>
<td>リクエストエラー</td>
</tr>
<tr>
<td>card_error</td>
<td>カードに関するエラー</td>
</tr>
<tr>
<td>server_error</td>
<td>PAY.JPや決済ネットワーク側のエラー</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>コード</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>invalid_number</td>
<td>不正なカード番号</td>
</tr>
<tr>
<td>invalid_cvc</td>
<td>不正なCVC</td>
</tr>
<tr>
<td>invalid_expiry_month</td>
<td>不正な有効期限月</td>
</tr>
<tr>
<td>invalid_expiry_year</td>
<td>不正な有効期限年</td>
</tr>
<tr>
<td>expired_card</td>
<td>有効期限切れ</td>
</tr>
<tr>
<td>card_declined</td>
<td>カード会社によって拒否されたカード</td>
</tr>
<tr>
<td>processing_error</td>
<td>決済ネットワーク上で生じたエラー</td>
</tr>
<tr>
<td>missing_card</td>
<td>顧客がカードを保持していない</td>
</tr>
<tr>
<td>invalid_id</td>
<td>不正なID</td>
</tr>
<tr>
<td>no_api_key</td>
<td>APIキーがセットされていない</td>
</tr>
<tr>
<td>invalid_api_key</td>
<td>不正なAPIキー</td>
</tr>
<tr>
<td>invalid_plan</td>
<td>不正なプラン</td>
</tr>
<tr>
<td>invalid_expiry_days</td>
<td>不正な失効日数</td>
</tr>
<tr>
<td>unnecessary_expiry_days</td>
<td>失効日数が不要なパラメーターである場合</td>
</tr>
<tr>
<td>invalid_flexible_id</td>
<td>不正なID指定</td>
</tr>
<tr>
<td>invalid_timestamp</td>
<td>不正なUnixタイムスタンプ</td>
</tr>
<tr>
<td>invalid_trial_end</td>
<td>不正なトライアル終了日</td>
</tr>
<tr>
<td>invalid_string_length</td>
<td>不正な文字列長</td>
</tr>
<tr>
<td>invalid_country</td>
<td>不正な国名コード</td>
</tr>
<tr>
<td>invalid_currency</td>
<td>不正な通貨コード</td>
</tr>
<tr>
<td>invalid_address_zip</td>
<td>不正な郵便番号</td>
</tr>
<tr>
<td>invalid_amount</td>
<td>不正な支払い金額</td>
</tr>
<tr>
<td>invalid_plan_amount</td>
<td>不正なプラン金額</td>
</tr>
<tr>
<td>invalid_card</td>
<td>不正なカード</td>
</tr>
<tr>
<td>invalid_customer</td>
<td>不正な顧客</td>
</tr>
<tr>
<td>invalid_boolean</td>
<td>不正な論理値</td>
</tr>
<tr>
<td>invalid_email</td>
<td>不正なメールアドレス</td>
</tr>
<tr>
<td>no_allowed_param</td>
<td>パラメーターが許可されていない場合</td>
</tr>
<tr>
<td>no_param</td>
<td>パラメーターが何もセットされていない</td>
</tr>
<tr>
<td>invalid_querystring</td>
<td>不正なクエリー文字列</td>
</tr>
<tr>
<td>missing_param</td>
<td>必要なパラメーターがセットされていない</td>
</tr>
<tr>
<td>invalid_param_key</td>
<td>指定できない不正なパラメーターがある</td>
</tr>
<tr>
<td>no_payment_method</td>
<td>支払い手段がセットされていない</td>
</tr>
<tr>
<td>payment_method_duplicate</td>
<td>支払い手段が重複してセットされている</td>
</tr>
<tr>
<td>payment_method_duplicate_including_customer</td>
<td>支払い手段が重複してセットされている(顧客IDを含む)</td>
</tr>
<tr>
<td>failed_payment</td>
<td>指定した支払いが失敗している場合</td>
</tr>
<tr>
<td>invalid_refund_amount</td>
<td>不正な返金額</td>
</tr>
<tr>
<td>already_refunded</td>
<td>すでに返金済み</td>
</tr>
<tr>
<td>cannot_refund_by_amount</td>
<td>返金済みの支払いに対して部分返金ができない</td>
</tr>
<tr>
<td>invalid_amount_to_not_captured</td>
<td>確定されていない支払いに対して部分返金ができない</td>
</tr>
<tr>
<td>refund_amount_gt_net</td>
<td>返金額が元の支払い額より大きい</td>
</tr>
<tr>
<td>capture_amount_gt_net</td>
<td>支払い確定額が元の支払い額より大きい</td>
</tr>
<tr>
<td>invalid_refund_reason</td>
<td>不正な返金理由</td>
</tr>
<tr>
<td>already_captured</td>
<td>すでに支払いが確定済み</td>
</tr>
<tr>
<td>cant_capture_refunded_charge</td>
<td>返金済みの支払いに対して支払い確定ができない</td>
</tr>
<tr>
<td>charge_expired</td>
<td>認証が失効している支払い</td>
</tr>
<tr>
<td>alerady_exist_id</td>
<td>すでに存在しているID</td>
</tr>
<tr>
<td>token_already_used</td>
<td>すでに使用済みのトークン</td>
</tr>
<tr>
<td>already_have_card</td>
<td>指定した顧客がすでに保持しているカード</td>
</tr>
<tr>
<td>dont_has_this_card</td>
<td>顧客が指定したカードを保持していない</td>
</tr>
<tr>
<td>doesnt_have_card</td>
<td>顧客がカードを何も保持していない</td>
</tr>
<tr>
<td>invalid_interval</td>
<td>不正な課金周期</td>
</tr>
<tr>
<td>invalid_trial_days</td>
<td>不正なトライアル日数</td>
</tr>
<tr>
<td>invalid_billing_day</td>
<td>不正な支払い実行日</td>
</tr>
<tr>
<td>exist_subscribers</td>
<td>購入者が存在するプランは削除できない</td>
</tr>
<tr>
<td>already_subscribed</td>
<td>すでに定期課金済みの顧客</td>
</tr>
<tr>
<td>already_canceled</td>
<td>すでにキャンセル済みの定期課金</td>
</tr>
<tr>
<td>already_pasued</td>
<td>すでに停止済みの定期課金</td>
</tr>
<tr>
<td>subscription_worked</td>
<td>すでに稼働している定期課金</td>
</tr>
<tr>
<td>test_card_on_livemode</td>
<td>本番モードのリクエストにテストカードが使用されている</td>
</tr>
<tr>
<td>not_activated_account</td>
<td>本番モードが許可されていないアカウント</td>
</tr>
<tr>
<td>too_many_test_request</td>
<td>テストモードのリクエストリミットを超過している</td>
</tr>
<tr>
<td>invalid_access</td>
<td>不正なアクセス</td>
</tr>
<tr>
<td>payjp_wrong</td>
<td>PAY.JPのサーバー側でエラーが発生している</td>
</tr>
<tr>
<td>pg_wrong</td>
<td>決済代行会社のサーバー側でエラーが発生している</td>
</tr>
<tr>
<td>not_found</td>
<td>リクエスト先が存在しないことを示す</td>
</tr>
<tr>
<td>not_allowed_method</td>
<td>許可されていないHTTPメソッド</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>リクエスト成功</td>
</tr>
<tr>
<td>400</td>
<td>不正なパラメーターなどのリクエストエラー</td>
</tr>
<tr>
<td>401</td>
<td>APIキーの認証エラー</td>
</tr>
<tr>
<td>402</td>
<td>カード認証・支払いエラー</td>
</tr>
<tr>
<td>404</td>
<td>存在しないAPIリソース</td>
</tr>
<tr>
<td>500</td>
<td>PAY.JPや決済ネットワークでの障害</td>
</tr>
</tbody></table>

<div name="エラーハンドリング" data-unique="エラーハンドリング"></div><h2 id="エラーハンドリング">エラーハンドリング</h2>
<pre class="highlight python" style="display: none;"><code><span class="k">try</span><span class="p">:</span>
    <span class="c"># Use Payjp's library to make requests...</span>
    <span class="k">pass</span>
<span class="k">except</span> <span class="n">payjp</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">CardError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="c"># Since it's a decline, payjp.error.CardError will be caught</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">json_body</span>
    <span class="n">err</span>  <span class="o">=</span> <span class="n">body</span><span class="p">[</span><span class="s">'error'</span><span class="p">]</span>

    <span class="k">print</span><span class="p">(</span><span class="s">'Status is: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">e</span><span class="o">.</span><span class="n">http_status</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Type is: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">err</span><span class="p">[</span><span class="s">'type'</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Code is: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">err</span><span class="p">[</span><span class="s">'code'</span><span class="p">])</span>
    <span class="c"># param is '' in this case</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Param is: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">err</span><span class="p">[</span><span class="s">'param'</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Message is: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">err</span><span class="p">[</span><span class="s">'message'</span><span class="p">])</span>
<span class="k">except</span> <span class="n">payjp</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">InvalidRequestError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="c"># Invalid parameters were supplied to Payjp's API</span>
    <span class="k">pass</span>
<span class="k">except</span> <span class="n">payjp</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">AuthenticationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="c"># Authentication with Payjp's API failed</span>
    <span class="c"># (maybe you changed API keys recently)</span>
    <span class="k">pass</span>
<span class="k">except</span> <span class="n">payjp</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">APIConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="c"># Network communication with Payjp failed</span>
    <span class="k">pass</span>
<span class="k">except</span> <span class="n">payjp</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">PayjpError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="c"># Display a very generic error to the user, and maybe send</span>
    <span class="c"># yourself an email</span>
    <span class="k">pass</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="c"># Something else happened, completely unrelated to Payjp</span>
    <span class="k">pass</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="k">begin</span>
  <span class="c1"># Use Payjp's library to make requests...</span>
<span class="k">rescue</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">CardError</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># Since it's a decline, Payjp::CardError will be caught</span>
  <span class="n">body</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="nf">json_body</span>
  <span class="n">err</span>  <span class="o">=</span> <span class="n">body</span><span class="p">[</span><span class="ss">:error</span><span class="p">]</span>

  <span class="nb">puts</span> <span class="s2">"Status is: </span><span class="si">#{</span><span class="n">e</span><span class="p">.</span><span class="nf">http_status</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">puts</span> <span class="s2">"Type is: </span><span class="si">#{</span><span class="n">err</span><span class="p">[</span><span class="ss">:type</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">puts</span> <span class="s2">"Code is: </span><span class="si">#{</span><span class="n">err</span><span class="p">[</span><span class="ss">:code</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
  <span class="c1"># param is '' in this case</span>
  <span class="nb">puts</span> <span class="s2">"Param is: </span><span class="si">#{</span><span class="n">err</span><span class="p">[</span><span class="ss">:param</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">puts</span> <span class="s2">"Message is: </span><span class="si">#{</span><span class="n">err</span><span class="p">[</span><span class="ss">:message</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
<span class="k">rescue</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">InvalidRequestError</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># Invalid parameters were supplied to Payjp's API</span>
<span class="k">rescue</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">AuthenticationError</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># Authentication with Payjp's API failed</span>
  <span class="c1"># (maybe you changed API keys recently)</span>
<span class="k">rescue</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">APIConnectionError</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># Network communication with Payjp failed</span>
<span class="k">rescue</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">PayjpError</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># Display a very generic error to the user, and maybe send</span>
  <span class="c1"># yourself an email</span>
<span class="k">rescue</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="c1"># Something else happened, completely unrelated to Payjp</span>
<span class="k">end</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>try {
  // Use Payjp's library to make requests...
} catch(\Payjp\Error\Card $e) {
  // Since it's a decline, \Payjp\Error\Card will be caught
  $body = $e-&gt;getJsonBody();
  $err  = $body['error'];

  print('Status is:' . $e-&gt;getHttpStatus() . "\n");
  print('Type is:' . $err['type'] . "\n");
  print('Code is:' . $err['code'] . "\n");
  // param is '' in this case
  print('Param is:' . $err['param'] . "\n");
  print('Message is:' . $err['message'] . "\n");
} catch (\Payjp\Error\InvalidRequest $e) {
  // Invalid parameters were supplied to Payjp's API
} catch (\Payjp\Error\Authentication $e) {
  // Authentication with Payjp's API failed
} catch (\Payjp\Error\ApiConnection $e) {
  // Network communication with Payjp failed
} catch (\Payjp\Error\Base $e) {
  // Display a very generic error to the user, and maybe send
  // yourself an email
} catch (Exception $e) {
  // Something else happened, completely unrelated to Payjp
}
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="c1">// e.g. payjp.customers.create({...})</span>

<span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="k">try</span> <span class="o">{</span>
  <span class="c1">// Use Payjp's library to make requests...</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">CardException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// Since it's a decline, CardException will be caught</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Status is: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">());</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Message is: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InvalidRequestException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// Invalid parameters were supplied to Payjp's API</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">AuthenticationException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// Authentication with Payjp's API failed</span>
  <span class="c1">// (maybe you changed API keys recently)</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">APIConnectionException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// Network communication with Payjp failed</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">PayjpException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// Display a very generic error to the user, and maybe send</span>
  <span class="c1">// yourself an email</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// Something else happened, completely unrelated to Payjp</span>
<span class="o">}</span>
</code></pre>

          <div name="pagination" data-unique="pagination"></div><h1 id="pagination">Pagination</h1>

<p>全てのトップレベルのAPIリソースでは、ページネーションを指定してデータを取得することができます。
例えば、直近の支払情報を10件まで取得したい場合、 <code class="prettyprint">limit=10</code> というクエリーを追加します。</p>

<table><thead>
<tr>
<th>クエリー</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>取得するデータ数の最大値(1~100まで)</td>
</tr>
<tr>
<td>offset</td>
<td>基準点からのデータ取得を行う開始位置</td>
</tr>
</tbody></table>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers?limit<span class="o">=</span>3&amp;offset<span class="o">=</span>10 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">customer</span><span class="o">.</span><span class="n">subscriptions</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">customer</span><span class="p">.</span><span class="nf">subscriptions</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="ss">limit: </span><span class="mi">3</span><span class="p">,</span> <span class="ss">offset: </span><span class="mi">10</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Customer::retrieve("cus_4df4b5ed720933f4fb9e28857517")-&gt;subscription-&gt;all(array("limit"=&gt;3, "offset"=&gt;10));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">limit</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="na">offset</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Customer</span> <span class="n">cu</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="o">);</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">listParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">listParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"limit"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
<span class="n">listParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"offset"</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="n">cu</span><span class="o">.</span><span class="na">getSubscriptions</span><span class="o">().</span><span class="na">all</span><span class="o">(</span><span class="n">listParams</span><span class="o">);</span>
</code></pre>

          <div name="metadata" data-unique="metadata"></div><h1 id="metadata">Metadata</h1>

<p>メタデータは、更新可能なオブジェクト(Charge, Customer, Card, Plan, Subscription)に任意のキーバリュー型のデータ持たせることのできるオブジェクトです。
例えば、請求書番号や注文番号などを支払いオブジェクトのメタデータに保存すれば、それらをPAY.JPの支払いオブジェクトから直接取得することが可能になります。</p>

<p>メタデータを利用するには、対象オブジェクトの作成もしくは更新リクエストに metadata[キー]=バリュー を追加します。</p>

<p>なお、一つのオブジェクトには最大20キーまで保存でき、キーは40文字まで、バリューは500文字までの文字列をセットすることができます。</p>

<p>詳しい実装については<a href="http://blog.pay.jp/entry/2016/02/22/100000">ブログ記事</a>もご覧ください。</p>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d metadata[user_id]<span class="o">=</span>123
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s">'user_id'</span><span class="p">:</span> <span class="mi">123</span><span class="p">}</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">metadata: </span><span class="p">{</span><span class="ss">user_id: </span><span class="mi">123</span><span class="p">}</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Customer::create(array(
        "metadata" =&gt; array("user_id" =&gt; "123")
));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="na">metadata</span><span class="p">:</span> <span class="p">{</span><span class="s1">'user_id'</span><span class="p">:</span> <span class="s1">'123'</span><span class="p">}</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">customerParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">initialMetadata</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;();</span>
<span class="n">initialMetadata</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"user_id"</span><span class="o">,</span> <span class="s">"123"</span><span class="o">);</span>
<span class="n">customerParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"metadata"</span><span class="o">,</span> <span class="n">initialMetadata</span><span class="o">);</span>
<span class="n">Customer</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">customerParams</span><span class="o">);</span>
</code></pre>

          <div name="charge-支払い" data-unique="charge-支払い"></div><h1 id="charge-支払い">Charge (支払い)</h1>

<p>都度の支払いや定期購入の引き落としのときに生成される、支払い情報のオブジェクトです。</p>

<div name="支払いを作成" data-unique="支払いを作成"></div><h2 id="支払いを作成">支払いを作成</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/charges</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/charges <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d <span class="nv">card</span><span class="o">=</span>tok_76e202b409f3da51a0706605ac81 <span class="se">\</span>
-d <span class="nv">amount</span><span class="o">=</span>3500 <span class="se">\</span>
-d <span class="nv">currency</span><span class="o">=</span>jpy
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">charge</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Charge</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">amount</span><span class="o">=</span><span class="mi">3500</span><span class="p">,</span>
    <span class="n">card</span><span class="o">=</span><span class="s">'tok_76e202b409f3da51a0706605ac81'</span><span class="p">,</span>
    <span class="n">currency</span><span class="o">=</span><span class="s">'jpy'</span><span class="p">,</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">charge</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Charge</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">:amount</span> <span class="o">=&gt;</span> <span class="mi">3500</span><span class="p">,</span>
  <span class="ss">:card</span> <span class="o">=&gt;</span> <span class="s1">'tok_76e202b409f3da51a0706605ac81'</span><span class="p">,</span>
  <span class="ss">:currency</span> <span class="o">=&gt;</span> <span class="s1">'jpy'</span><span class="p">,</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Charge::create(array(
        "card" =&gt; "tok_76e202b409f3da51a0706605ac81",
        "amount" =&gt; 3500,
        "currency" =&gt; "jpy"
));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="na">card</span><span class="p">:</span> <span class="s1">'tok_76e202b409f3da51a0706605ac81'</span><span class="p">,</span>
  <span class="na">amount</span><span class="p">:</span> <span class="mi">3500</span><span class="p">,</span>
  <span class="na">currency</span><span class="p">:</span> <span class="s1">'jpy'</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">chargeParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">chargeParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"card"</span><span class="o">,</span> <span class="s">"tok_76e202b409f3da51a0706605ac81"</span><span class="o">);</span>
<span class="n">chargeParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="mi">3500</span><span class="o">);</span>
<span class="n">chargeParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"currency"</span><span class="o">,</span> <span class="s">"jpy"</span><span class="o">);</span>
<span class="n">Charge</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">chargeParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">3500</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2020</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_d0e44730f83b0a19ba6caee04160"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ch_fa990a4c10672a93053a774730b0a"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refund_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_number"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your card number is invalid."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card[number]"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>トークンID、カードを保有している顧客ID、カードオブジェクトのいずれかのパラメーターを指定して支払いを作成します。
テスト用のキーでは、本番用の決済ネットワークへは接続されず、実際の請求が行われることもありません。
本番用のキーでは、決済ネットワークで処理が行われ、実際の請求が行われます。</p>

<p>支払いを確定せずに、カードの認証と支払い額のみ確保する場合は、 <code class="prettyprint">capture</code> に <code class="prettyprint">false</code> を指定してください。
このとき <code class="prettyprint">expiry_days</code> を指定することで、認証の期間を定めることができます。 <code class="prettyprint">expiry_days</code> はデフォルトで7日となっており、1日~60日の間で設定が可能です。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td>Integer</td>
<td><span class="required"><strong>必須</strong></span><br>50~9,999,999の整数</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td><span class="required"><strong>必須</strong></span><br>3文字のISOコード(現状 “jpy” のみサポート)</td>
</tr>
<tr>
<td>customer</td>
<td>String</td>
<td>顧客ID (cardかcustomerのどちらかは<strong>必須</strong>パラメータ)</td>
</tr>
<tr>
<td>card</td>
<td>String</td>
<td>トークンID (cardかcustomerのどちらかは<strong>必須</strong>パラメータ)</td>
</tr>
<tr>
<td>card</td>
<td>Object</td>
<td>カードオブジェクト(cardかcustomerのどちらかは<strong>必須</strong>)</td>
</tr>
<tr>
<td>card[number]</td>
<td>String</td>
<td>カード番号</td>
</tr>
<tr>
<td>card[exp_month]</td>
<td>String</td>
<td>有効期限月</td>
</tr>
<tr>
<td>card[exp_year]</td>
<td>String</td>
<td>有効期限年</td>
</tr>
<tr>
<td>card[cvc]</td>
<td>String</td>
<td>3~4桁のCVCコード</td>
</tr>
<tr>
<td>card[address_state]</td>
<td>String</td>
<td>都道府県</td>
</tr>
<tr>
<td>card[address_city]</td>
<td>String</td>
<td>市区町村</td>
</tr>
<tr>
<td>card[address_line1]</td>
<td>String</td>
<td>番地など</td>
</tr>
<tr>
<td>card[address_line2]</td>
<td>String</td>
<td>建物名など</td>
</tr>
<tr>
<td>card[address_zip]</td>
<td>String</td>
<td>郵便番号</td>
</tr>
<tr>
<td>card[name]</td>
<td>String</td>
<td>カード保有者名(e.g. “YUI ARAGAKI”)</td>
</tr>
<tr>
<td>card[country]</td>
<td>String</td>
<td>2桁のISOコード(e.g. JP)</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>概要</td>
</tr>
<tr>
<td>capture</td>
<td>Boolean</td>
<td>支払い処理を確定するかどうか (falseの場合、カードの認証と支払い額の確保のみ行う)</td>
</tr>
<tr>
<td>expiry_days</td>
<td>Integer</td>
<td>認証状態が失効するまでの日数</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="支払いを情報を取得" data-unique="支払いを情報を取得"></div><h2 id="支払いを情報を取得">支払いを情報を取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/charges/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/charges/ch_fa990a4c10672a93053a774730b0a <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Charge</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'ch_fa990a4c10672a93053a774730b0a'</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Charge</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'ch_fa990a4c10672a93053a774730b0a'</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Charge::retrieve("ch_fa990a4c10672a93053a774730b0a");
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span><span class="s1">'ch_fa990a4c10672a93053a774730b0a'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Charge</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"ch_fa990a4c10672a93053a774730b0a"</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">3500</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2020</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_d0e44730f83b0a19ba6caee04160"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ch_fa990a4c10672a93053a774730b0a"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refund_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no charge with ID: dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>生成された支払い情報を取得します。</p>

<table><thead>
<tr>
<th>プロパティ名</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>object</td>
<td>String</td>
<td>オブジェクト名 <em>値は"charge"</em></td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>ch_で始まる一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>livemode</td>
<td>Boolean</td>
<td>本番環境かどうか</td>
</tr>
<tr>
<td>created</td>
<td>Integer</td>
<td>この支払い作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>amount</td>
<td>Integer</td>
<td>支払い額</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>3文字のISOコード(現状 “jpy” のみサポート)</td>
</tr>
<tr>
<td>paid</td>
<td>Boolean</td>
<td>認証処理が成功しているかどうか。</td>
</tr>
<tr>
<td>expired_at</td>
<td>Integer</td>
<td>認証状態が自動的に失効される日時のタイムスタンプ</td>
</tr>
<tr>
<td>captured</td>
<td>Boolean</td>
<td>支払い処理を確定しているかどうか</td>
</tr>
<tr>
<td>captured_at</td>
<td>Integer</td>
<td>支払い処理確定時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>card</td>
<td>Dictionary</td>
<td>支払いされたクレジットカードの情報</td>
</tr>
<tr>
<td>card[object]</td>
<td>String</td>
<td>オブジェクト名 <em>値は"card"</em></td>
</tr>
<tr>
<td>card[id]</td>
<td>String</td>
<td>car_で始まる一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>card[created]</td>
<td>Integer</td>
<td>カード作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>card[name]</td>
<td>String</td>
<td>カード保有者名(e.g. YUI ARAGAKI)</td>
</tr>
<tr>
<td>card[last4]</td>
<td>String</td>
<td>カード番号の下四桁</td>
</tr>
<tr>
<td>card[exp_month]</td>
<td>String</td>
<td>有効期限月</td>
</tr>
<tr>
<td>card[exp_year]</td>
<td>String</td>
<td>有効期限年</td>
</tr>
<tr>
<td>card[brand]</td>
<td>String</td>
<td>カードブランド名</td>
</tr>
<tr>
<td>card[cvc_check]</td>
<td>String</td>
<td>CVCコードチェックの結果</td>
</tr>
<tr>
<td>card[fingerprint]</td>
<td>String</td>
<td>このクレジットカード番号に紐づけられた一意（他と重複しない）キー</td>
</tr>
<tr>
<td>card[address_city]</td>
<td>String</td>
<td>市区町村</td>
</tr>
<tr>
<td>card[address_line1]</td>
<td>String</td>
<td>番地など</td>
</tr>
<tr>
<td>card[address_line2]</td>
<td>String</td>
<td>建物名など</td>
</tr>
<tr>
<td>card[address_state]</td>
<td>String</td>
<td>都道府県</td>
</tr>
<tr>
<td>card[country]</td>
<td>String</td>
<td>2桁のISOコード(e.g. JP)</td>
</tr>
<tr>
<td>card[address_zip]</td>
<td>String</td>
<td>郵便番号</td>
</tr>
<tr>
<td>card[address_zip_check]</td>
<td>String</td>
<td>郵便番号存在チェックの結果</td>
</tr>
<tr>
<td>customer</td>
<td>String</td>
<td>顧客ID</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>概要</td>
</tr>
<tr>
<td>failure_code</td>
<td>String</td>
<td>失敗した支払いのエラーコード</td>
</tr>
<tr>
<td>failure_message</td>
<td>String</td>
<td>失敗した支払いの説明</td>
</tr>
<tr>
<td>refunded</td>
<td>Boolean</td>
<td>返金済みかどうか</td>
</tr>
<tr>
<td>amount_refunded</td>
<td>Integer</td>
<td>この支払いに対しての返金額</td>
</tr>
<tr>
<td>refund_reason</td>
<td>String</td>
<td>返金理由</td>
</tr>
<tr>
<td>subscription</td>
<td>String</td>
<td>sub_から始まる定期課金のID</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="支払い情報を更新" data-unique="支払い情報を更新"></div><h2 id="支払い情報を更新">支払い情報を更新</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/charges/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/charges/ch_fa990a4c10672a93053a774730b0a <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d <span class="nv">description</span><span class="o">=</span>Updated
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">charge</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Charge</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'ch_fa990a4c10672a93053a774730b0a'</span><span class="p">)</span>
<span class="n">charge</span><span class="o">.</span><span class="n">description</span><span class="o">=</span><span class="s">'Updated'</span>
<span class="n">charge</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">charge</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Charge</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'ch_fa990a4c10672a93053a774730b0a'</span><span class="p">)</span>
<span class="n">charge</span><span class="p">.</span><span class="nf">description</span><span class="o">=</span><span class="s1">'Updated'</span>
<span class="n">charge</span><span class="p">.</span><span class="nf">save</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$ch = \Payjp\Charge::retrieve("ch_fa990a4c10672a93053a774730b0a");
$ch-&gt;description = "Updated";
$ch-&gt;save();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="s1">'ch_fa990a4c10672a93053a774730b0a'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">description</span><span class="p">:</span> <span class="s1">'Updated'</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Charge</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">Charge</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"ch_fa990a4c10672a93053a774730b0a"</span><span class="o">);</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">updateParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">updateParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"description"</span><span class="o">,</span> <span class="s">"Updated"</span><span class="o">);</span>
<span class="n">ch</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">updateParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">3500</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2020</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_d0e44730f83b0a19ba6caee04160"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Updated"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ch_fa990a4c10672a93053a774730b0a"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refund_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_param_key"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid param key to charge."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>支払い情報を更新します。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>description</td>
<td>String</td>
<td>概要</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="返金する" data-unique="返金する"></div><h2 id="返金する">返金する</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/charges/:id/refund</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/charges/ch_fa990a4c10672a93053a774730b0a/refund <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-XPOST
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">charge</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Charge</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'ch_fa990a4c10672a93053a774730b0a'</span><span class="p">)</span>
<span class="n">charge</span><span class="o">.</span><span class="n">refund</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">charge</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Charge</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'ch_fa990a4c10672a93053a774730b0a'</span><span class="p">)</span>
<span class="n">charge</span><span class="p">.</span><span class="nf">refund</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$ch = \Payjp\Charge::retrieve("ch_fa990a4c10672a93053a774730b0a");
$ch-&gt;refund();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">refund</span><span class="p">(</span><span class="s1">'ch_fa990a4c10672a93053a774730b0a'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Charge</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">Charge</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"ch_fa990a4c10672a93053a774730b0a"</span><span class="o">);</span>
<span class="n">ch</span><span class="o">.</span><span class="na">refund</span><span class="o">();</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">3500</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">3500</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2020</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_d0e44730f83b0a19ba6caee04160"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Updated"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ch_fa990a4c10672a93053a774730b0a"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refund_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Charge `ch_fa990a4c10672a93053a774730b0a` has already been refunded."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>支払い済みとなった処理を返金します。全額返金、及び <code class="prettyprint">amount</code> を指定することで金額の部分返金を行うことができます。ただし部分返金を最初に行った場合、2度目の返金は全額返金しか行うことができないため、ご注意ください。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td>Integer</td>
<td>1~9,999,999の整数</td>
</tr>
<tr>
<td>refund_reason</td>
<td>string</td>
<td>返金理由</td>
</tr>
</tbody></table>

<div name="支払い処理を確定する" data-unique="支払い処理を確定する"></div><h2 id="支払い処理を確定する">支払い処理を確定する</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/charges/:id/capture</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/charges/ch_cce2fce62e9cb5632b3d38b0b1621/capture <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-XPOST
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">charge</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Charge</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'ch_fa990a4c10672a93053a774730b0a'</span><span class="p">)</span>
<span class="n">charge</span><span class="o">.</span><span class="n">capture</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">charge</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Charge</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'ch_cce2fce62e9cb5632b3d38b0b1621'</span><span class="p">)</span>
<span class="n">charge</span><span class="p">.</span><span class="nf">capture</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$ch = \Payjp\Charge::retrieve("ch_cce2fce62e9cb5632b3d38b0b1621");
$ch-&gt;capture();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">capture</span><span class="p">(</span><span class="s1">'ch_fa990a4c10672a93053a774730b0a'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Charge</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">Charge</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"ch_cce2fce62e9cb5632b3d38b0b1621"</span><span class="o">);</span>
<span class="n">ch</span><span class="o">.</span><span class="na">capture</span><span class="o">();</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">3500</span><span class="p">,</span><span class="w">
  </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"captured_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433128911</span><span class="p">,</span><span class="w">
  </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2020</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_8eeadf285ef2c6da507eb1aebc93"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433429999</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ch_cce2fce62e9cb5632b3d38b0b1621"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refund_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Charge `ch_cce2fce62e9cb5632b3d38b0b1621` has already been captured."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>認証状態となった処理待ちの支払い処理を確定させます。具体的には <code class="prettyprint">captured="false"</code> となった支払いが該当します。</p>

<p><code class="prettyprint">amount</code> をセットすることで、支払い生成時の金額と異なる金額の支払い処理を行うことができます。
ただし <code class="prettyprint">amount</code> は、支払い生成時の金額よりも少額である必要があるためご注意ください。</p>

<p><code class="prettyprint">amount</code> をセットした場合、<code class="prettyprint">amount_refunded</code> に認証時の <code class="prettyprint">amount</code> との差額が入ります。</p>

<p>例えば、認証時に <code class="prettyprint">amount=500</code> で作成し、 <code class="prettyprint">amount=400</code> で支払い確定を行った場合、 <code class="prettyprint">amount_refunded=100</code> となり、確定金額が400円に変更された状態で支払いが確定されます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td>Integer</td>
<td>50~9,999,999の整数</td>
</tr>
</tbody></table>

<div name="支払いリストを取得" data-unique="支払いリストを取得"></div><h2 id="支払いリストを取得">支払いリストを取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/charges</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl <span class="s1">'https://api.pay.jp/v1/charges?limit=3&amp;offset=10'</span> <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Charge</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Charge</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="ss">limit: </span><span class="mi">3</span><span class="p">,</span> <span class="ss">offset: </span><span class="mi">10</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Charge::all(array("limit" =&gt; 3, "offset" =&gt; 10));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">charges</span><span class="p">.</span><span class="nx">list</span><span class="p">({</span>
  <span class="na">limit</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="na">offset</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">chargeParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">chargeParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"limit"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
<span class="n">chargeParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"offset"</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="n">Charge</span><span class="o">.</span><span class="na">all</span><span class="o">(</span><span class="n">chargeParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
      </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"captured_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
      </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"\u8d64\u5742"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7-4"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"203"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"\u6e2f\u533a"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1070050"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passed"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JP"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
        </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passed"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
        </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
        </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_7a79b41fed704317ec0deb4ebf93"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test Hodler"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
      </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_67fab69c14d8888bba941ae2009b"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test charge"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ch_6421ddf0e12a5e5641d7426f2a2c9"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"refund_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/charges"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid query string."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>生成した支払い情報のリストを取得します。リストは、直近で生成された順番に取得されます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>Integer</td>
<td>1〜100</td>
</tr>
<tr>
<td>offset</td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td>customer</td>
<td>String</td>
<td>顧客ID</td>
</tr>
<tr>
<td>subscription</td>
<td>String</td>
<td>定期課金ID</td>
</tr>
<tr>
<td>since</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以降に作成されたデータを取得</td>
</tr>
<tr>
<td>until</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以前に作成されたデータを取得</td>
</tr>
</tbody></table>

          <div name="customer-顧客" data-unique="customer-顧客"></div><h1 id="customer-顧客">Customer (顧客)</h1>

<p>顧客を管理するためのオブジェクトです。</p>

<p>顧客における都度の支払いや定期購入、複数カードの管理など、さまざまなことができます。作成した顧客は、あとからカードを追加・更新・削除したり、顧客自体を削除することができます。</p>

<div name="顧客を作成" data-unique="顧客を作成"></div><h2 id="顧客を作成">顧客を作成</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/customers</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d <span class="nv">description</span><span class="o">=</span><span class="nb">test</span>
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">description</span><span class="o">=</span><span class="s">'test'</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">description: </span><span class="s1">'test'</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Customer::create(array(
        "description" =&gt; "test"
));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="na">description</span><span class="p">:</span> <span class="s1">'test'</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">customerParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">customerParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"description"</span><span class="o">,</span> <span class="s">"test"</span><span class="o">);</span>
<span class="n">Customer</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">customerParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"cards"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_121673955bd7aa144de5a8f6c262/cards"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"default_card"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_121673955bd7aa144de5a8f6c262"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_121673955bd7aa144de5a8f6c262/subscriptions"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_param_key"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid param key to customer."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>メールアドレスやIDなどを指定して顧客を作成します。</p>

<p>作成と同時にカード情報を登録する場合、トークンIDかカードオブジェクトのどちらかを指定します。</p>

<p>作成した顧客やカード情報はあとから更新・削除することができます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>String</td>
<td>メールアドレス</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>概要</td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>一意の顧客ID</td>
</tr>
<tr>
<td>card</td>
<td>String</td>
<td>トークンID(トークンIDかカードオブジェクトのどちらかのみ指定可能)</td>
</tr>
<tr>
<td>card</td>
<td>Object</td>
<td>カードオブジェクト(トークンIDかカードオブジェクトのどちらかのみ指定可能)</td>
</tr>
<tr>
<td>card[number]</td>
<td>String</td>
<td>カード番号</td>
</tr>
<tr>
<td>card[exp_month]</td>
<td>String</td>
<td>有効期限月</td>
</tr>
<tr>
<td>card[exp_year]</td>
<td>String</td>
<td>有効期限年</td>
</tr>
<tr>
<td>card[cvc]</td>
<td>String</td>
<td>3~4桁のCVCコード</td>
</tr>
<tr>
<td>card[address_state]</td>
<td>String</td>
<td>都道府県</td>
</tr>
<tr>
<td>card[address_city]</td>
<td>String</td>
<td>市区町村</td>
</tr>
<tr>
<td>card[address_line1]</td>
<td>String</td>
<td>番地など</td>
</tr>
<tr>
<td>card[address_line2]</td>
<td>String</td>
<td>建物名など</td>
</tr>
<tr>
<td>card[address_zip]</td>
<td>String</td>
<td>郵便番号</td>
</tr>
<tr>
<td>card[country]</td>
<td>String</td>
<td>2桁のISOコード(e.g. JP)</td>
</tr>
<tr>
<td>card[name]</td>
<td>String</td>
<td>カード保有者名(e.g. “YUI ARAGAKI”)</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="顧客情報を取得" data-unique="顧客情報を取得"></div><h2 id="顧客情報を取得">顧客情報を取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/customers/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers/cus_121673955bd7aa144de5a8f6c262 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">)</span>

</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Customer::retrieve("cus_121673955bd7aa144de5a8f6c262");
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span><span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Customer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"cus_121673955bd7aa144de5a8f6c262"</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"cards"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_121673955bd7aa144de5a8f6c262/cards"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"default_card"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_121673955bd7aa144de5a8f6c262"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_121673955bd7aa144de5a8f6c262/subscriptions"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no customer with ID: dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>生成した顧客情報を取得します。</p>

<table><thead>
<tr>
<th>プロパティ名</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>object</td>
<td>String</td>
<td>オブジェクト名 <em>値は"customer"</em></td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>livemode</td>
<td>Boolean</td>
<td>本番環境かどうか</td>
</tr>
<tr>
<td>created</td>
<td>Integer</td>
<td>この顧客作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>default_card</td>
<td>String</td>
<td>支払いに使用されるカードのcar_から始まるID</td>
</tr>
<tr>
<td>cards</td>
<td>List</td>
<td>この顧客に紐づけられているカードのリスト</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>メールアドレス</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>概要</td>
</tr>
<tr>
<td>subscriptions</td>
<td>List</td>
<td>この顧客が購読している定期課金のリスト</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="顧客情報を更新" data-unique="顧客情報を更新"></div><h2 id="顧客情報を更新">顧客情報を更新</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/customers/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers/cus_121673955bd7aa144de5a8f6c262 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d <span class="nv">email</span><span class="o">=</span>added@example.com
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">)</span>
<span class="n">customer</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="s">'added@example.com'</span>
<span class="n">customer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">)</span>
<span class="n">customer</span><span class="p">.</span><span class="nf">email</span> <span class="o">=</span> <span class="s1">'added@example.com'</span>
<span class="n">customer</span><span class="p">.</span><span class="nf">save</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Customer::retrieve("cus_121673955bd7aa144de5a8f6c262");
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">email</span><span class="p">:</span> <span class="s1">'example@example.com'</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Customer</span> <span class="n">cu</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"cus_121673955bd7aa144de5a8f6c262"</span><span class="o">);</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">updateParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">updateParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"email"</span><span class="o">,</span> <span class="s">"added@example.com"</span><span class="o">);</span>
<span class="n">cu</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">updateParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"cards"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_121673955bd7aa144de5a8f6c262/cards"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"default_card"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_121673955bd7aa144de5a8f6c262"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_121673955bd7aa144de5a8f6c262/subscriptions"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no customer with ID: dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>生成した顧客情報を更新したり、新たなカードを顧客に追加することができます。また <code class="prettyprint">default_card</code> に保持しているカードIDを指定することで、メイン利用のカードを変更することもできます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>String</td>
<td>メールアドレス</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>概要</td>
</tr>
<tr>
<td>default_card</td>
<td>String</td>
<td>保持しているカードID</td>
</tr>
<tr>
<td>card</td>
<td>String</td>
<td>トークンID(トークンIDかカードオブジェクトのどちらかのみ指定可能)</td>
</tr>
<tr>
<td>card</td>
<td>Object</td>
<td>カードオブジェクト(トークンIDかカードオブジェクトのどちらかのみ指定可能)</td>
</tr>
<tr>
<td>card[number]</td>
<td>String</td>
<td>カード番号</td>
</tr>
<tr>
<td>card[exp_month]</td>
<td>String</td>
<td>有効期限月</td>
</tr>
<tr>
<td>card[exp_year]</td>
<td>String</td>
<td>有効期限年</td>
</tr>
<tr>
<td>card[cvc]</td>
<td>String</td>
<td>3~4桁のCVCコード</td>
</tr>
<tr>
<td>card[address_state]</td>
<td>String</td>
<td>都道府県</td>
</tr>
<tr>
<td>card[address_city]</td>
<td>String</td>
<td>市区町村</td>
</tr>
<tr>
<td>card[address_line1]</td>
<td>String</td>
<td>番地など</td>
</tr>
<tr>
<td>card[address_line2]</td>
<td>String</td>
<td>建物名など</td>
</tr>
<tr>
<td>card[address_zip]</td>
<td>String</td>
<td>郵便番号</td>
</tr>
<tr>
<td>card[country]</td>
<td>String</td>
<td>2桁のISOコード(e.g. JP)</td>
</tr>
<tr>
<td>card[name]</td>
<td>String</td>
<td>カード保有者名(e.g. “YUI ARAGAKI”)</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="顧客を削除" data-unique="顧客を削除"></div><h2 id="顧客を削除">顧客を削除</h2>

<blockquote>
<p>DELETE https://api.pay.jp/v1/customers/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers/cus_121673955bd7aa144de5a8f6c262 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-XDELETE
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">)</span>
<span class="n">customer</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">)</span>
<span class="n">customer</span><span class="p">.</span><span class="nf">delete</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$cu = \Payjp\Customer::retrieve("cus_121673955bd7aa144de5a8f6c262");
$cu-&gt;delete();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Customer</span> <span class="n">cu</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"cus_121673955bd7aa144de5a8f6c262"</span><span class="o">);</span>
<span class="n">cu</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_121673955bd7aa144de5a8f6c262"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no customer with ID: cus_121673955bd7aa144de5a8f6c262"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>生成した顧客情報を削除します。削除した顧客情報は、もう一度生成することができないためご注意ください。</p>

<div name="顧客リストを取得" data-unique="顧客リストを取得"></div><h2 id="顧客リストを取得">顧客リストを取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/customers</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers?limit<span class="o">=</span>3&amp;offset<span class="o">=</span>10 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="ss">limit: </span><span class="mi">3</span><span class="p">,</span> <span class="ss">offset: </span><span class="mi">10</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Customer::all(array("limit" =&gt; 3, "offset" =&gt; 10));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">list</span><span class="p">({</span>
  <span class="na">limit</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="na">offset</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">customerParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">customerParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"limit"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
<span class="n">customerParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"offset"</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="n">Customer</span><span class="o">.</span><span class="na">all</span><span class="o">(</span><span class="n">customerParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"cards"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_842e21be700d1c8156d9dac025f6/cards"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433059905</span><span class="p">,</span><span class="w">
      </span><span class="nt">"default_card"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_842e21be700d1c8156d9dac025f6"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_842e21be700d1c8156d9dac025f6/subscriptions"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_param_key"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid param key to customer."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>生成した顧客情報のリストを取得します。リストは、直近で生成された順番に取得されます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>Integer</td>
<td>1〜100</td>
</tr>
<tr>
<td>offset</td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td>since</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以降に作成されたデータを取得</td>
</tr>
<tr>
<td>until</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以前に作成されたデータを取得</td>
</tr>
</tbody></table>

<div name="顧客のカードを作成" data-unique="顧客のカードを作成"></div><h2 id="顧客のカードを作成">顧客のカードを作成</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/customers/:id/cards</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers/cus_4df4b5ed720933f4fb9e28857517/cards <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d <span class="nv">card</span><span class="o">=</span>tok_76e202b409f3da51a0706605ac81
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">)</span>
<span class="n">customer</span><span class="o">.</span><span class="n">cards</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">card</span><span class="o">=</span><span class="s">'tok_76e202b409f3da51a0706605ac81'</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">customer</span><span class="p">.</span><span class="nf">cards</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">card: </span><span class="s1">'tok_76e202b409f3da51a0706605ac81'</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$cu = \Payjp\Customer::retrieve("cus_4df4b5ed720933f4fb9e28857517");
$cu-&gt;cards-&gt;create(card=&gt;"tok_76e202b409f3da51a0706605ac81");
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">card</span><span class="p">:</span> <span class="s1">'car_f7d9fa98594dc7c2e42bfcd641ff'</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Customer</span> <span class="n">cu</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="o">);</span>
<span class="n">cu</span><span class="o">.</span><span class="na">createCard</span><span class="o">(</span><span class="s">"card"</span><span class="o">,</span> <span class="s">"tok_76e202b409f3da51a0706605ac81"</span><span class="o">)</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2020</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_f7d9fa98594dc7c2e42bfcd641ff"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Please provide either token or card parameters."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>トークンIDかカード情報のパラメーターのどちらかを指定して、新たにカードを追加します。ただし同じカード番号および同じ有効期限年/月のカードは、重複追加することができません。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>card</td>
<td>String</td>
<td>トークンID(トークンIDか下記カード情報のパラメーターのどちらかのみ指定可能)</td>
</tr>
<tr>
<td>number</td>
<td>String</td>
<td>カード番号</td>
</tr>
<tr>
<td>exp_month</td>
<td>String</td>
<td>有効期限月</td>
</tr>
<tr>
<td>exp_year</td>
<td>String</td>
<td>有効期限年</td>
</tr>
<tr>
<td>cvc</td>
<td>String</td>
<td>3~4桁のCVCコード</td>
</tr>
<tr>
<td>address_state</td>
<td>String</td>
<td>都道府県</td>
</tr>
<tr>
<td>address_city</td>
<td>String</td>
<td>市区町村</td>
</tr>
<tr>
<td>address_line1</td>
<td>String</td>
<td>番地など</td>
</tr>
<tr>
<td>address_line2</td>
<td>String</td>
<td>建物名など</td>
</tr>
<tr>
<td>address_zip</td>
<td>String</td>
<td>郵便番号</td>
</tr>
<tr>
<td>country</td>
<td>String</td>
<td>2桁のISOコード(e.g. JP)</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>カード保有者名(e.g. “YUI ARAGAKI”)</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="顧客のカード情報を取得" data-unique="顧客のカード情報を取得"></div><h2 id="顧客のカード情報を取得">顧客のカード情報を取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/customers/:id/cards/:card_id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers/cus_4df4b5ed720933f4fb9e28857517/cards/car_f7d9fa98594dc7c2e42bfcd641ff <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">customer</span><span class="o">.</span><span class="n">cards</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'car_f7d9fa98594dc7c2e42bfcd641ff'</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">customer</span><span class="p">.</span><span class="nf">cards</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'car_f7d9fa98594dc7c2e42bfcd641ff'</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$cu = \Payjp\Customer::retrieve("cus_4df4b5ed720933f4fb9e28857517");
$cu-&gt;cards-&gt;retrieve("car_f7d9fa98594dc7c2e42bfcd641ff");
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span>
  <span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">,</span>
  <span class="s1">'car_f7d9fa98594dc7c2e42bfcd641ff'</span>
<span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Customer</span> <span class="n">cu</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="o">);</span>
<span class="n">cu</span><span class="o">.</span><span class="na">getCards</span><span class="o">().</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"car_f7d9fa98594dc7c2e42bfcd641ff"</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2020</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_f7d9fa98594dc7c2e42bfcd641ff"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no card with ID: dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>顧客の特定のカード情報を取得します。</p>

<table><thead>
<tr>
<th>プロパティ名</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>object</td>
<td>String</td>
<td>オブジェクト名 <em>値は"card"</em></td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>car_で始まる一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>created</td>
<td>Integer</td>
<td>カード作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>カード保有者名(e.g. “YUI ARAGAKI”)</td>
</tr>
<tr>
<td>last4</td>
<td>String</td>
<td>カード番号の下四桁</td>
</tr>
<tr>
<td>exp_month</td>
<td>String</td>
<td>有効期限月</td>
</tr>
<tr>
<td>exp_year</td>
<td>String</td>
<td>有効期限年</td>
</tr>
<tr>
<td>brand</td>
<td>String</td>
<td>カードブランド名</td>
</tr>
<tr>
<td>cvc_check</td>
<td>String</td>
<td>CVCコードチェックの結果</td>
</tr>
<tr>
<td>fingerprint</td>
<td>String</td>
<td>このクレジットカード番号に紐づけられた一意（他と重複しない）キー</td>
</tr>
<tr>
<td>address_state</td>
<td>String</td>
<td>都道府県</td>
</tr>
<tr>
<td>address_city</td>
<td>String</td>
<td>市区町村</td>
</tr>
<tr>
<td>address_line1</td>
<td>String</td>
<td>番地など</td>
</tr>
<tr>
<td>address_line2</td>
<td>String</td>
<td>建物名など</td>
</tr>
<tr>
<td>country</td>
<td>String</td>
<td>2桁のISOコード(e.g. JP)</td>
</tr>
<tr>
<td>address_zip</td>
<td>String</td>
<td>郵便番号</td>
</tr>
<tr>
<td>address_zip_check</td>
<td>String</td>
<td>郵便番号存在チェックの結果</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="顧客のカードを更新" data-unique="顧客のカードを更新"></div><h2 id="顧客のカードを更新">顧客のカードを更新</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/customers/:id/cards/:card_id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers/cus_4df4b5ed720933f4fb9e28857517/cards/car_f7d9fa98594dc7c2e42bfcd641ff <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d <span class="nv">exp_year</span><span class="o">=</span>2026 <span class="se">\</span>
-d <span class="nv">exp_month</span><span class="o">=</span>05
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">customer</span><span class="o">.</span><span class="n">cards</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'car_f7d9fa98594dc7c2e42bfcd641ff'</span><span class="p">)</span>
<span class="n">card</span><span class="o">.</span><span class="n">exp_year</span><span class="o">=</span><span class="mi">2026</span>
<span class="n">card</span><span class="o">.</span><span class="n">exp_month</span><span class="o">=</span><span class="mi">2</span>
<span class="n">card</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">customer</span><span class="p">.</span><span class="nf">cards</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'car_f7d9fa98594dc7c2e42bfcd641ff'</span><span class="p">)</span>
<span class="n">card</span><span class="p">.</span><span class="nf">exp_year</span><span class="o">=</span><span class="mi">2026</span>
<span class="n">card</span><span class="p">.</span><span class="nf">exp_month</span><span class="o">=</span><span class="mi">2</span>
<span class="n">card</span><span class="p">.</span><span class="nf">save</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$cu = \Payjp\Customer::retrieve("cus_4df4b5ed720933f4fb9e28857517");
$card = $cu-&gt;cards-&gt;retrieve("car_f7d9fa98594dc7c2e42bfcd641ff");
$card-&gt;exp_year = "2026";
$card-&gt;exp_month = "05";
$card-&gt;save();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span>
  <span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">,</span>
  <span class="s1">'car_f7d9fa98594dc7c2e42bfcd641ff'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">exp_year</span><span class="p">:</span> <span class="mi">2026</span><span class="p">,</span>
  <span class="na">exp_month</span><span class="p">:</span> <span class="mi">5</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Customer</span> <span class="n">cu</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="o">);</span>
<span class="n">Card</span> <span class="n">ca</span> <span class="o">=</span> <span class="n">cu</span><span class="o">.</span><span class="na">getCards</span><span class="o">().</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"car_f7d9fa98594dc7c2e42bfcd641ff"</span><span class="o">);</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">updateParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">updateParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"exp_year"</span><span class="o">,</span> <span class="s">"2026"</span><span class="o">);</span>
<span class="n">updateParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"exp_month"</span><span class="o">,</span> <span class="s">"05"</span><span class="o">);</span>
<span class="n">ca</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">updateParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
  </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2026</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_f7d9fa98594dc7c2e42bfcd641ff"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_param_key"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid param key to card."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>顧客の特定のカード情報を更新します。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>exp_month</td>
<td>String</td>
<td>有効期限月</td>
</tr>
<tr>
<td>exp_year</td>
<td>String</td>
<td>有効期限年</td>
</tr>
<tr>
<td>cvc</td>
<td>String</td>
<td>3~4桁のCVCコード</td>
</tr>
<tr>
<td>address_state</td>
<td>String</td>
<td>都道府県</td>
</tr>
<tr>
<td>address_city</td>
<td>String</td>
<td>市区町村</td>
</tr>
<tr>
<td>address_line1</td>
<td>String</td>
<td>番地など</td>
</tr>
<tr>
<td>address_line2</td>
<td>String</td>
<td>建物名など</td>
</tr>
<tr>
<td>address_zip</td>
<td>String</td>
<td>郵便番号</td>
</tr>
<tr>
<td>country</td>
<td>String</td>
<td>2桁のISOコード(e.g. JP)</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>カード保有者名(e.g. “YUI ARAGAKI”)</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="顧客のカードを削除" data-unique="顧客のカードを削除"></div><h2 id="顧客のカードを削除">顧客のカードを削除</h2>

<blockquote>
<p>DELETE https://api.pay.jp/v1/customers/:id/cards/:card_id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers/cus_4df4b5ed720933f4fb9e28857517/cards/car_f7d9fa98594dc7c2e42bfcd641ff <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-XDELETE
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">customer</span><span class="o">.</span><span class="n">cards</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'car_f7d9fa98594dc7c2e42bfcd641ff'</span><span class="p">)</span>
<span class="n">card</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">customer</span><span class="p">.</span><span class="nf">cards</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'car_f7d9fa98594dc7c2e42bfcd641ff'</span><span class="p">)</span>
<span class="n">card</span><span class="p">.</span><span class="nf">delete</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$cu = \Payjp\Customer::retrieve("cus_4df4b5ed720933f4fb9e28857517");
$card = $cu-&gt;cards-&gt;retrieve("car_f7d9fa98594dc7c2e42bfcd641ff");
$card-&gt;delete();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span>
  <span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">,</span>
  <span class="s1">'car_f7d9fa98594dc7c2e42bfcd641ff'</span>
<span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Customer</span> <span class="n">cu</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="o">);</span>
<span class="n">Card</span> <span class="n">ca</span> <span class="o">=</span> <span class="n">cu</span><span class="o">.</span><span class="na">getCards</span><span class="o">().</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"car_f7d9fa98594dc7c2e42bfcd641ff"</span><span class="o">);</span>
<span class="n">ca</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_f7d9fa98594dc7c2e42bfcd641ff"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no card with ID: car_f7d9fa98594dc7c2e42bfcd641ff"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>顧客の特定のカードを削除します。</p>

<div name="顧客のカードリストを取得" data-unique="顧客のカードリストを取得"></div><h2 id="顧客のカードリストを取得">顧客のカードリストを取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/customers/:id/cards</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl <span class="s2">"https://api.pay.jp/v1/customers/cus_4df4b5ed720933f4fb9e28857517/cards?limit=3&amp;offset=1"</span> <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">customer</span><span class="o">.</span><span class="n">cards</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">card</span> <span class="o">=</span> <span class="n">customer</span><span class="p">.</span><span class="nf">cards</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="ss">limit: </span><span class="mi">3</span><span class="p">,</span> <span class="ss">offset: </span><span class="mi">10</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Customer::retrieve("cus_4df4b5ed720933f4fb9e28857517")-&gt;cards-&gt;all(array("limit"=&gt;3, "offset"=&gt;1));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">cards</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">limit</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="na">offset</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">listParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">listParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"limit"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
<span class="n">listParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"offset"</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
<span class="n">Customer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="o">).</span><span class="na">getCards</span><span class="o">().</span><span class="na">all</span><span class="o">(</span><span class="n">listParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2020</span><span class="p">,</span><span class="w">
      </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_f7d9fa98594dc7c2e42bfcd641ff"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_4df4b5ed720933f4fb9e28857517/cards"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_param_key"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid param key to card."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>顧客の保持しているカードリストを取得します。リストは、直近で生成された順番に取得されます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>Integer</td>
<td>1〜100</td>
</tr>
<tr>
<td>offset</td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td>since</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以降に作成されたデータを取得</td>
</tr>
<tr>
<td>until</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以前に作成されたデータを取得</td>
</tr>
</tbody></table>

<div name="顧客の定期課金情報を取得" data-unique="顧客の定期課金情報を取得"></div><h2 id="顧客の定期課金情報を取得">顧客の定期課金情報を取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/cusotmers/:id/subscriptions/:subscription_id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers/cus_4df4b5ed720933f4fb9e28857517/subscriptions/sub_567a1e44562932ec1a7682d746e0 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">customer</span><span class="o">.</span><span class="n">subscriptions</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">customer</span><span class="p">.</span><span class="nf">subscriptions</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$cu = \Payjp\Customer::retrieve("cus_4df4b5ed720933f4fb9e28857517");
$cu-&gt;subscription-&gt;retrieve("sub_567a1e44562932ec1a7682d746e0");
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span>
  <span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">,</span>
  <span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span>
<span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Customer</span> <span class="n">cu</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="o">);</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">listParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">listParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"limit"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
<span class="n">cu</span><span class="o">.</span><span class="na">getSubscriptions</span><span class="o">().</span><span class="na">all</span><span class="o">(</span><span class="n">listParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1435732422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433140422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sub_567a1e44562932ec1a7682d746e0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paused_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_9589006d14aad86aafeceac06b60"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"prorate"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"resumed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433140422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no subscription with ID: dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>顧客の特定の定期課金情報を取得します。</p>

<table><thead>
<tr>
<th>プロパティ名</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>object</td>
<td>String</td>
<td>オブジェクト名 <em>値は"subscription"</em></td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>sub_で始まる一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>livemode</td>
<td>Boolean</td>
<td>本番環境かどうか</td>
</tr>
<tr>
<td>created</td>
<td>Integer</td>
<td>この定期課金作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>start</td>
<td>Integer</td>
<td>この定期課金開始時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>customer</td>
<td>String</td>
<td>この定期課金を購読している顧客のID</td>
</tr>
<tr>
<td>plan</td>
<td>Dictionary</td>
<td>この定期課金のプラン情報</td>
</tr>
<tr>
<td>plan[object]</td>
<td>String</td>
<td>オブジェクト名 <em>値は"plan"</em></td>
</tr>
<tr>
<td>plan[id]</td>
<td>String</td>
<td>一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>plan[created]</td>
<td>Integer</td>
<td>このプラン作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>plan[amount]</td>
<td>Integer</td>
<td>プラン金額</td>
</tr>
<tr>
<td>plan[currency]</td>
<td>String</td>
<td>3文字のISOコード(現状 “jpy” のみサポート)</td>
</tr>
<tr>
<td>plan[interval]</td>
<td>String</td>
<td>課金周期(現状"month"のみサポート)</td>
</tr>
<tr>
<td>plan[name]</td>
<td>String</td>
<td>プラン名</td>
</tr>
<tr>
<td>plan[trial_days]</td>
<td>Integer</td>
<td>トライアル日数</td>
</tr>
<tr>
<td>plan[billing_day]</td>
<td>Integer</td>
<td>課金日(1-31)</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>この定期課金の現在の状態</td>
</tr>
<tr>
<td>current_period_start</td>
<td>Integer</td>
<td>現在の購読期間開始時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>current_period_end</td>
<td>Integer</td>
<td>現在の購読期間終了時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>trial_start</td>
<td>Integer</td>
<td>トライアル期間開始時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>trial_end</td>
<td>Integer</td>
<td>トライアル期間終了時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>paused_at</td>
<td>Integer</td>
<td>定期課金が停止状態になった時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>canceled_at</td>
<td>Integer</td>
<td>定期課金がキャンセル状態になった時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>resumed_at</td>
<td>Integer</td>
<td>停止またはキャンセル状態の定期課金が有効状態になった時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="顧客の定期課金リストを取得" data-unique="顧客の定期課金リストを取得"></div><h2 id="顧客の定期課金リストを取得">顧客の定期課金リストを取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/customers/:id/subscriptions</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/customers/cus_4df4b5ed720933f4fb9e28857517/subscriptions?limit<span class="o">=</span>3 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Customer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">customer</span><span class="o">.</span><span class="n">subscriptions</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">customer</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Customer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'cus_4df4b5ed720933f4fb9e28857517'</span><span class="p">)</span>
<span class="n">customer</span><span class="p">.</span><span class="nf">subscriptions</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="ss">limit: </span><span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Customer::retrieve("cus_4df4b5ed720933f4fb9e28857517")-&gt;subscription-&gt;all(array("limit"=&gt;3));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">customers</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="s1">'cus_121673955bd7aa144de5a8f6c262'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">limit</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="na">offset</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Customer</span> <span class="n">cu</span> <span class="o">=</span> <span class="n">Customer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="o">);</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">listParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">listParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"limit"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
<span class="n">cu</span><span class="o">.</span><span class="na">getSubscriptions</span><span class="o">().</span><span class="na">all</span><span class="o">(</span><span class="n">listParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
      </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1435732422</span><span class="p">,</span><span class="w">
      </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433140422</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sub_567a1e44562932ec1a7682d746e0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"paused_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"plan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
        </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
        </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_9589006d14aad86aafeceac06b60"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test plan"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"prorate"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"resumed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433140422</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_4df4b5ed720933f4fb9e28857517/subscriptions"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_param_key"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid param key to subscription."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>顧客の定期課金リストを取得します。リストは、直近で生成された順番に取得されます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>Integer</td>
<td>1〜100</td>
</tr>
<tr>
<td>offset</td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td>plan</td>
<td>String</td>
<td>プランID</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>ステータス(active, trial, canceled, paused)</td>
</tr>
<tr>
<td>since</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以降に作成されたデータを取得</td>
</tr>
<tr>
<td>until</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以前に作成されたデータを取得</td>
</tr>
</tbody></table>

          <div name="plan-プラン" data-unique="plan-プラン"></div><h1 id="plan-プラン">Plan (プラン)</h1>

<p>定期購入のときに使用する静的なプラン情報です。</p>

<p>金額、支払い実行日(1-31)、トライアル日数などを指定して、
あなたのビジネスに必要なさまざまなプランを生成することができます。</p>

<p>生成したプランは、顧客と紐付けて定期購入処理を行うことができます。</p>

<div name="プランを作成" data-unique="プランを作成"></div><h2 id="プランを作成">プランを作成</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/plans</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/plans <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d <span class="nv">amount</span><span class="o">=</span>500 <span class="se">\</span>
-d <span class="nv">currency</span><span class="o">=</span>jpy <span class="se">\</span>
-d <span class="nv">interval</span><span class="o">=</span>month <span class="se">\</span>
-d <span class="nv">trial_days</span><span class="o">=</span>30
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Plan</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">amount</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">currency</span><span class="o">=</span><span class="s">'jpy'</span><span class="p">,</span>
    <span class="n">interval</span><span class="o">=</span><span class="s">'month'</span><span class="p">,</span>
    <span class="n">trial_days</span><span class="o">=</span><span class="mi">30</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Plan</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">amount: </span><span class="mi">500</span><span class="p">,</span>
  <span class="ss">currency: </span><span class="s1">'jpy'</span><span class="p">,</span>
  <span class="ss">interval: </span><span class="s1">'month'</span><span class="p">,</span>
  <span class="ss">trial_days: </span><span class="mi">30</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Plan::create(array(
        "amount" =&gt; 500,
        "currency" =&gt; "jpy",
        "interval" =&gt; "month",
        "trial_days" =&gt; 30,
));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="na">amount</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
  <span class="na">currency</span><span class="p">:</span> <span class="s1">'jpy'</span><span class="p">,</span>
  <span class="na">interval</span><span class="p">:</span> <span class="s1">'month'</span><span class="p">,</span>
  <span class="na">trial_days</span><span class="p">:</span> <span class="mi">30</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">planParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">planParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"amount"</span><span class="o">,</span> <span class="mi">500</span><span class="o">);</span>
<span class="n">planParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"currency"</span><span class="o">,</span> <span class="s">"jpy"</span><span class="o">);</span>
<span class="n">planParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"interval"</span><span class="o">,</span> <span class="s">"month"</span><span class="o">);</span>
<span class="n">planParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"trial_days"</span><span class="o">,</span> <span class="mi">30</span><span class="o">);</span>
<span class="n">Plan</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">planParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
  </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_45dd3268a18b2837d52861716260"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_interval"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid interval"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"interval"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>金額や通貨などを指定して定期購入に利用するプランを生成します。</p>

<p>トライアル日数を指定することで、トライアル付きのプランを生成することができます。</p>

<p>また、支払いの実行日を指定すると、支払い日の固定されたプランを生成することができます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td>Integer</td>
<td><span class="required"><strong>必須</strong></span><br>50~9,999,999の整数</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td><span class="required"><strong>必須</strong></span><br>3文字のISOコード(現状 “jpy” のみサポート)</td>
</tr>
<tr>
<td>interval</td>
<td>String</td>
<td><span class="required"><strong>必須</strong></span><br>month のみ指定可能</td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>プランID</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>プランの名前</td>
</tr>
<tr>
<td>trial_days</td>
<td>Integer</td>
<td>トライアル日数</td>
</tr>
<tr>
<td>billing_day</td>
<td>Integer</td>
<td>支払いの実行日(1〜31)</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="プラン情報を取得" data-unique="プラン情報を取得"></div><h2 id="プラン情報を取得">プラン情報を取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/plans/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/plans/pln_45dd3268a18b2837d52861716260 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Plan</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'pln_45dd3268a18b2837d52861716260'</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Plan</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'pln_45dd3268a18b2837d52861716260'</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Plan::retrieve("pln_45dd3268a18b2837d52861716260");
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span><span class="s1">'pln_45dd3268a18b2837d52861716260'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Plan</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"pln_45dd3268a18b2837d52861716260"</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
  </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_45dd3268a18b2837d52861716260"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no plan with ID: dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>特定のプラン情報を取得します。</p>

<table><thead>
<tr>
<th>プロパティ名</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>object</td>
<td>String</td>
<td>オブジェクト名 <em>値は"plan"</em></td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>livemode</td>
<td>Boolean</td>
<td>本番環境かどうか</td>
</tr>
<tr>
<td>created</td>
<td>Integer</td>
<td>このプラン作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>amount</td>
<td>Integer</td>
<td>プラン金額</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>3文字のISOコード(現状 “jpy” のみサポート)</td>
</tr>
<tr>
<td>interval</td>
<td>String</td>
<td>課金周期(現状"month"のみサポート)</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>プラン名</td>
</tr>
<tr>
<td>trial_days</td>
<td>Integer</td>
<td>トライアル日数</td>
</tr>
<tr>
<td>billing_day</td>
<td>Integer</td>
<td>課金日(1-31)</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="プランを更新" data-unique="プランを更新"></div><h2 id="プランを更新">プランを更新</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/plans/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/plans/pln_45dd3268a18b2837d52861716260 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d <span class="nv">name</span><span class="o">=</span>NewPlan
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">plan</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Plan</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'pln_45dd3268a18b2837d52861716260'</span><span class="p">)</span>
<span class="n">plan</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'NewPlan'</span>
<span class="n">plan</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">plan</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Plan</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'pln_45dd3268a18b2837d52861716260'</span><span class="p">)</span>
<span class="n">plan</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="s1">'NewPlan'</span>
<span class="n">plan</span><span class="p">.</span><span class="nf">save</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$p = \Payjp\Plan::retrieve("pln_45dd3268a18b2837d52861716260");
$p-&gt;name = "NewPlan";
$p-&gt;save();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="s1">'pln_45dd3268a18b2837d52861716260'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span> <span class="s1">'NewPlan'</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Plan</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Plan</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"pln_45dd3268a18b2837d52861716260"</span><span class="o">);</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">updateParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">updateParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="s">"NewPlan"</span><span class="o">);</span>
<span class="n">p</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">updateParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
  </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_45dd3268a18b2837d52861716260"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NewPlan"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_param_key"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid param key to plan."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"amount"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>プラン情報を更新します。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>String</td>
<td>プランの名前</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="プランを削除" data-unique="プランを削除"></div><h2 id="プランを削除">プランを削除</h2>

<blockquote>
<p>DELETE https://api.pay.jp/v1/plans/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/plans/pln_45dd3268a18b2837d52861716260 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-XDELETE
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">plan</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Plan</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'pln_45dd3268a18b2837d52861716260'</span><span class="p">)</span>
<span class="n">plan</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">plan</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Plan</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'pln_45dd3268a18b2837d52861716260'</span><span class="p">)</span>
<span class="n">plan</span><span class="p">.</span><span class="nf">delete</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$p = \Payjp\Plan::retrieve("pln_45dd3268a18b2837d52861716260");
$p-&gt;delete();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'pln_45dd3268a18b2837d52861716260'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Plan</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Plan</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"pln_45dd3268a18b2837d52861716260"</span><span class="o">);</span>
<span class="n">p</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_45dd3268a18b2837d52861716260"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no plan with ID: pln_45dd3268a18b2837d52861716260"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>プランを削除します。</p>

<div name="プランリストを取得" data-unique="プランリストを取得"></div><h2 id="プランリストを取得">プランリストを取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/plans</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/plans?limit<span class="o">=</span>3 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Plan</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Plan</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="ss">limit: </span><span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Plan::all(array("limit" =&gt; 3));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">plans</span><span class="p">.</span><span class="nx">list</span><span class="p">({</span>
  <span class="na">limit</span><span class="p">:</span> <span class="mi">3</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">listParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">listParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"limit"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
<span class="n">Plan</span><span class="o">.</span><span class="na">all</span><span class="o">(</span><span class="n">listParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
      </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
      </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_acfbc08ae710da03ac2a3fcb2334"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test plan"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/plans"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_param_key"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid param key to plan."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>生成したプランのリストを取得します。リストは、直近で生成された順番に取得されます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>Integer</td>
<td>取得するデータ数の最大値(1~100まで)</td>
</tr>
<tr>
<td>offset</td>
<td>Integer</td>
<td>基準点からのデータ取得を行う開始位置</td>
</tr>
<tr>
<td>since</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以降に作成されたデータを取得</td>
</tr>
<tr>
<td>until</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以前に作成されたデータを取得</td>
</tr>
</tbody></table>

          <div name="subscription-定期課金" data-unique="subscription-定期課金"></div><h1 id="subscription-定期課金">Subscription (定期課金)</h1>

<p>月単位で定期的な支払い処理を行います。顧客IDとプランIDを指定して生成します。</p>

<p><code class="prettyprint">stauts="trial"</code> の場合は支払いは行われず、<code class="prettyprint">status="active"</code> の場合のみ支払いが行われます。</p>

<p>支払い処理は、はじめに定期課金を生成した瞬間に行われ、そこを基準にして定期的な支払いが行われていきます。
定期課金は、顧客に複数紐付けるができ、生成した定期課金は停止・再開・キャンセル・削除することができます。</p>

<p>詳しい実装方法については <a href="https://pay.jp/docs/subscription">チュートリアル - 定期課金</a> をご覧ください。</p>

<div name="定期課金を作成" data-unique="定期課金を作成"></div><h2 id="定期課金を作成">定期課金を作成</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/subscriptions</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/subscriptions <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d <span class="nv">customer</span><span class="o">=</span>cus_4df4b5ed720933f4fb9e28857517 <span class="se">\</span>
-d <span class="nv">plan</span><span class="o">=</span>pln_9589006d14aad86aafeceac06b60
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Subscription</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">plan</span><span class="o">=</span><span class="s">'pln_9589006d14aad86aafeceac06b60'</span><span class="p">,</span>
    <span class="n">customer</span><span class="o">=</span><span class="s">'cus_4df4b5ed720933f4fb9e28857517'</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">plan: </span><span class="s1">'pln_9589006d14aad86aafeceac06b60'</span><span class="p">,</span>
  <span class="ss">customer: </span><span class="s1">'cus_4df4b5ed720933f4fb9e28857517'</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Subscription::create(
        array(
                "customer" =&gt; "cus_4df4b5ed720933f4fb9e28857517",
                "plan" =&gt; "pln_9589006d14aad86aafeceac06b60"
        )
);
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="na">plan</span><span class="p">:</span> <span class="s1">'pln_9589006d14aad86aafeceac06b60'</span><span class="p">,</span>
  <span class="na">customer</span><span class="p">:</span> <span class="s1">'cus_4df4b5ed720933f4fb9e28857517'</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">subscriptionParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">subscriptionParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"plan"</span><span class="o">,</span> <span class="s">"pln_9589006d14aad86aafeceac06b60"</span><span class="o">);</span>
<span class="n">subscriptionParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"customer"</span><span class="o">,</span> <span class="s">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="o">);</span>
<span class="n">Subscription</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">subscriptionParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1435732422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433140422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sub_567a1e44562932ec1a7682d746e0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paused_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_9589006d14aad86aafeceac06b60"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"resumed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433140422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"prorate"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"missing_param"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing required param to subscription."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>顧客IDとプランIDを指定して、定期課金を開始することができます。trial_endを指定することで、プラン情報を上書きするトライアル設定も可能です。
最初の支払いは定期課金作成時に実行されます。支払い実行日(billing_day)が指定されているプランの場合は日割り設定(prorate)を有効化しない限り、作成時よりもあとの支払い実行日に最初の支払いが行われます。</p>

<p>トライアル設定がある場合は、トライアル終了時に支払い処理が行われ、そこを基準にして定期課金が開始されます。支払い実行日(billing_day)が指定されている場合も同様に、トライアル終了時に支払い処理(日割り設定(prorate)が有効の場合は日割額、無効の場合は満額)が行われますのでご注意ください。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>customer</td>
<td>String</td>
<td><span class="required"><strong>必須</strong></span><br>顧客ID</td>
</tr>
<tr>
<td>plan</td>
<td>String</td>
<td><span class="required"><strong>必須</strong></span><br>プランID</td>
</tr>
<tr>
<td>trial_end</td>
<td>Integer</td>
<td>リクエスト時より未来のUTCタイムスタンプ</td>
</tr>
<tr>
<td>trial_end</td>
<td>String</td>
<td>nowのみ指定可能</td>
</tr>
<tr>
<td>prorate</td>
<td>Boolean</td>
<td>日割り課金を設定するかどうか(デフォルトはfalse)</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="定期課金情報を取得" data-unique="定期課金情報を取得"></div><h2 id="定期課金情報を取得">定期課金情報を取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/subscriptions/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/subscriptions/sub_567a1e44562932ec1a7682d746e0 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Subscription</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Subscription::retrieve("sub_567a1e44562932ec1a7682d746e0");
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Subscription</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"sub_567a1e44562932ec1a7682d746e0"</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1435732422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433140422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sub_567a1e44562932ec1a7682d746e0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paused_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_9589006d14aad86aafeceac06b60"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"resumed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433140422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"prorate"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no subscription with ID: dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>生成した特定の定期課金情報を取得します。</p>

<table><thead>
<tr>
<th>プロパティ名</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>object</td>
<td>String</td>
<td>オブジェクト名 <em>値は"subscription"</em></td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>sub_で始まる一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>livemode</td>
<td>Boolean</td>
<td>本番環境かどうか</td>
</tr>
<tr>
<td>created</td>
<td>Integer</td>
<td>この定期課金作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>start</td>
<td>Integer</td>
<td>この定期課金開始時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>customer</td>
<td>String</td>
<td>この定期課金を購読している顧客のID</td>
</tr>
<tr>
<td>plan</td>
<td>Dictionary</td>
<td>この定期課金のプラン情報</td>
</tr>
<tr>
<td>plan[object]</td>
<td>String</td>
<td>オブジェクト名 <em>値は"plan"</em></td>
</tr>
<tr>
<td>plan[id]</td>
<td>String</td>
<td>一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>plan[created]</td>
<td>Integer</td>
<td>このプラン作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>plan[amount]</td>
<td>Integer</td>
<td>プラン金額</td>
</tr>
<tr>
<td>plan[currency]</td>
<td>String</td>
<td>3文字のISOコード(現状 “jpy” のみサポート)</td>
</tr>
<tr>
<td>plan[interval]</td>
<td>String</td>
<td>課金周期(現状"month"のみサポート)</td>
</tr>
<tr>
<td>plan[name]</td>
<td>String</td>
<td>プラン名</td>
</tr>
<tr>
<td>plan[trial_days]</td>
<td>Integer</td>
<td>トライアル日数</td>
</tr>
<tr>
<td>plan[billing_day]</td>
<td>Integer</td>
<td>課金日(1-31)</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>この定期課金の現在の状態</td>
</tr>
<tr>
<td>prorate</td>
<td>Boolean</td>
<td>日割り課金が有効かどうか</td>
</tr>
<tr>
<td>current_period_start</td>
<td>Integer</td>
<td>現在の購読期間開始時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>current_period_end</td>
<td>Integer</td>
<td>現在の購読期間終了時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>trial_start</td>
<td>Integer</td>
<td>トライアル期間開始時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>trial_end</td>
<td>Integer</td>
<td>トライアル期間終了時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>paused_at</td>
<td>Integer</td>
<td>定期課金が停止状態になった時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>canceled_at</td>
<td>Integer</td>
<td>定期課金がキャンセル状態になった時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>resumed_at</td>
<td>Integer</td>
<td>停止またはキャンセル状態の定期課金が有効状態になった時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="定期課金を更新" data-unique="定期課金を更新"></div><h2 id="定期課金を更新">定期課金を更新</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/subscriptions/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/subscriptions/sub_567a1e44562932ec1a7682d746e0 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d <span class="nv">trial_end</span><span class="o">=</span>1473911903
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Subscription</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
<span class="n">subscription</span><span class="o">.</span><span class="n">trial_end</span> <span class="o">=</span> <span class="mi">1473911903</span>
<span class="n">subscription</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">trial_end</span> <span class="o">=</span> <span class="mi">1473911903</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">save</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$su = \Payjp\Subscription::retrieve("sub_567a1e44562932ec1a7682d746e0");
$su-&gt;trial_end = 1473911903;
$su-&gt;save();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">trial_end</span><span class="p">:</span> <span class="mi">1473911903</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Subscription</span> <span class="n">su</span> <span class="o">=</span> <span class="n">Subscription</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"sub_567a1e44562932ec1a7682d746e0"</span><span class="o">);</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">updateParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">updateParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"trial_end"</span><span class="o">,</span> <span class="mi">1473911903</span><span class="o">);</span>
<span class="n">su</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">updateParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1435732422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433140422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_4df4b5ed720933f4fb9e28857517"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sub_567a1e44562932ec1a7682d746e0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paused_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
    </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433127983</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_68e6a67f582462c223ca693bc549"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"week"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weekly_plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"resumed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433140422</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"trial"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1473911903</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433140922</span><span class="p">,</span><span class="w">
  </span><span class="nt">"prorate"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no plan with ID: dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>トライアル期間を新たに設定したり、プランの変更を行うことができます。</p>

<p>トライアル期間を更新する場合、トライアル期間終了時に支払い処理が行われ、
そこを基準としてプランに沿った周期で定期課金が再開されます。
このトライアル期間を利用すれば、定期課金の開始日を任意の日にずらすこともできます。
また <code class="prettyprint">trial_end=now</code> とする事により、トライアル期間中の定期課金を即時開始できます。</p>

<p>プランを変更する場合は、 <code class="prettyprint">plan</code> に新しいプランのIDを指定してください。同時に <code class="prettyprint">prorate=true</code> とする事により、
日割り課金を有効化できます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>trial_end</td>
<td>Integer</td>
<td>リクエスト時より未来のUTCタイムスタンプ</td>
</tr>
<tr>
<td>trial_end</td>
<td>String</td>
<td>nowのみ指定可能</td>
</tr>
<tr>
<td>plan</td>
<td>String</td>
<td>プランID</td>
</tr>
<tr>
<td>prorate</td>
<td>Boolean</td>
<td>日割り課金を設定するかどうか</td>
</tr>
<tr>
<td>metadata</td>
<td>Object</td>
<td>キーバリューの任意データ</td>
</tr>
</tbody></table>

<div name="定期課金を停止" data-unique="定期課金を停止"></div><h2 id="定期課金を停止">定期課金を停止</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/subscriptions/:id/pause</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/subscriptions/sub_f9fb5ef2507b46c00a1a84c47bed/pause <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-XPOST
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Subscription</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
<span class="n">subscription</span><span class="o">.</span><span class="n">pause</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">pause</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$su = \Payjp\Subscription::retrieve("sub_567a1e44562932ec1a7682d746e0");
$su-&gt;pause();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">pause</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Subscription</span> <span class="n">su</span> <span class="o">=</span> <span class="n">Subscription</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"sub_567a1e44562932ec1a7682d746e0"</span><span class="o">);</span>
<span class="n">su</span><span class="o">.</span><span class="na">pause</span><span class="o">();</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1435643801</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965401</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_2498ea9cb54644f4516a9bf6dc78"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sub_f9fb5ef2507b46c00a1a84c47bed"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paused_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433141463</span><span class="p">,</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_acfbc08ae710da03ac2a3fcb2334"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"resumed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965401</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"paused"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"prorate"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Subscription `sub_f9fb5ef2507b46c00a1a84c47bed` already has been paused"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>引き落としの失敗やカードが不正である、また定期課金を停止したい場合はこのリクエストで定期購入を停止させます。</p>

<p>定期課金を停止させると、再開されるまで引き落とし処理は一切行われません。</p>

<div name="定期課金を再開" data-unique="定期課金を再開"></div><h2 id="定期課金を再開">定期課金を再開</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/subscriptions/:id/resume</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/subscriptions/sub_f9fb5ef2507b46c00a1a84c47bed/resume <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-XPOST
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Subscription</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
<span class="n">subscription</span><span class="o">.</span><span class="n">resume</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">resume</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$su = \Payjp\Subscription::retrieve("sub_567a1e44562932ec1a7682d746e0");
$su-&gt;resume();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">resume</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Subscription</span> <span class="n">su</span> <span class="o">=</span> <span class="n">Subscription</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"sub_567a1e44562932ec1a7682d746e0"</span><span class="o">);</span>
<span class="n">su</span><span class="o">.</span><span class="na">resume</span><span class="o">();</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1435733621</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433141621</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_2498ea9cb54644f4516a9bf6dc78"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sub_f9fb5ef2507b46c00a1a84c47bed"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paused_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_acfbc08ae710da03ac2a3fcb2334"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"resumed_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433141621</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433141621</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"prorate"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Subscription `sub_f9fb5ef2507b46c00a1a84c47bed` already has been worked."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>停止もしくはキャンセル状態の定期課金を再開させます。
トライアル日数が残っていて再開日がトライアル終了日時より前の場合、
トライアル状態で定期課金が再開されます。</p>

<p><code class="prettyprint">trial_end</code> を指定することで、トライアル終了日を任意の日時に再指定する事が出来ます。</p>

<p>再開時に <code class="prettyprint">current_period_end</code> が過去の日時の場合、先に支払いの試行が行われます。例えば、支払いの失敗により停止した場合、 <code class="prettyprint">current_period_end</code> は支払い失敗時の値になるため、必ず過去の日時がセットされます。
再開時の支払いに失敗すると、定期課金は再開されません。</p>

<p>この場合は、有効なカードを顧客のデフォルトカードにセットしてから、再度定期課金の再開を行ってください。</p>

<p>また<code class="prettyprint">prorate</code> を指定することで、日割り課金を有効化することができます。
日割り課金が有効な場合は、再開日より課金日( <code class="prettyprint">billing_day</code> )までの日数分で日割りした金額が課金されます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>trial_end</td>
<td>Integer</td>
<td>リクエスト時より未来のUTCタイムスタンプ</td>
</tr>
<tr>
<td>prorate</td>
<td>Boolean</td>
<td>日割り課金を設定するかどうか</td>
</tr>
</tbody></table>

<div name="定期課金をキャンセル" data-unique="定期課金をキャンセル"></div><h2 id="定期課金をキャンセル">定期課金をキャンセル</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/subscriptions/:id/cancel</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/subscriptions/sub_19f6a2123363b514a743d1334109/cancel <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-XPOST
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Subscription</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
<span class="n">subscription</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">cancel</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$su = \Payjp\Subscription::retrieve("sub_567a1e44562932ec1a7682d746e0");
$su-&gt;cancel();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">cancel</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Subscription</span> <span class="n">su</span> <span class="o">=</span> <span class="n">Subscription</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"sub_567a1e44562932ec1a7682d746e0"</span><span class="o">);</span>
<span class="n">su</span><span class="o">.</span><span class="na">cancel</span><span class="o">();</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1433141780</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1435643801</span><span class="p">,</span><span class="w">
  </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965401</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_d43eb7c419c0da28ca0fd414108e"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sub_19f6a2123363b514a743d1334109"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"paused_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"plan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_01b0370fb0918777b952257302d5"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"resumed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965401</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"canceled"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"prorate"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Subscription `sub_19f6a2123363b514a743d1334109` already has been canceled"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>定期課金をキャンセルし、現在の周期の終了日をもって定期課金を終了させます。</p>

<p>終了日以前であれば、定期課金の再開リクエスト(/resume)を行うことで、
キャンセルを取り消すことができます。終了日をむかえた定期課金は、自動的に削除されますのでご注意ください。</p>

<div name="定期課金を削除" data-unique="定期課金を削除"></div><h2 id="定期課金を削除">定期課金を削除</h2>

<blockquote>
<p>DELETE https://api.pay.jp/v1/subscriptions/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/subscriptions/sub_19f6a2123363b514a743d1334109 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-XDELETE
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Subscription</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
<span class="n">subscription</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">subscription</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">)</span>
<span class="n">subscription</span><span class="p">.</span><span class="nf">delete</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$su = \Payjp\Subscription::retrieve("sub_567a1e44562932ec1a7682d746e0");
$su-&gt;delete();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Subscription</span> <span class="n">su</span> <span class="o">=</span> <span class="n">Subscription</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"sub_567a1e44562932ec1a7682d746e0"</span><span class="o">);</span>
<span class="n">su</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sub_19f6a2123363b514a743d1334109"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no subscription with ID: sub_19f6a2123363b514a743d1334109"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>定期課金をすぐに削除します。次回以降の課金は行われずに、一度削除した定期課金は、再び戻すことができません。
日割り設定(prorate)を有効化すると、削除時から現在の周期の終了日までの日割り分を算出し、同時に返金処理を行います。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>prorate</td>
<td>Boolean</td>
<td>日割り課金を設定するかどうか</td>
</tr>
</tbody></table>

<div name="定期課金のリストを取得" data-unique="定期課金のリストを取得"></div><h2 id="定期課金のリストを取得">定期課金のリストを取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/subscriptions</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/subscriptions?limit<span class="o">=</span>3 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Subscription</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Subscription</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="ss">limit: </span><span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Subscription::all(array("limit" =&gt; 3));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">list</span><span class="p">(</span><span class="s1">'sub_567a1e44562932ec1a7682d746e0'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">limit</span><span class="p">:</span> <span class="mi">3</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">listParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">listParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"limit"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
<span class="n">Subscription</span><span class="o">.</span><span class="na">all</span><span class="o">(</span><span class="n">listParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"canceled_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
      </span><span class="nt">"current_period_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1435643801</span><span class="p">,</span><span class="w">
      </span><span class="nt">"current_period_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965401</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_ca2676897435d6476c4f6205a6f5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sub_80ac5ef1c0073a3e443a7d7deb93"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subscription"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"paused_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"plan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
        </span><span class="nt">"billing_day"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965397</span><span class="p">,</span><span class="w">
        </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pln_9589006d14aad86aafeceac06b60"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
        </span><span class="nt">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test plan"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plan"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"trial_days"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"resumed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1432965401</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trial_end"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trial_start"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"prorate"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/subscriptions"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_param_key"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid param key to subscription."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>生成した定期課金のリストを取得します。リストは、直近で生成された順番に取得されます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>Integer</td>
<td>1〜100</td>
</tr>
<tr>
<td>offset</td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td>plan</td>
<td>String</td>
<td>プランID</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>ステータス(active, trial, canceled, paused)</td>
</tr>
<tr>
<td>since</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以降に作成されたデータを取得</td>
</tr>
<tr>
<td>until</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以前に作成されたデータを取得</td>
</tr>
</tbody></table>

          <div name="token-トークン" data-unique="token-トークン"></div><h1 id="token-トークン">Token (トークン)</h1>

<p>Là token object thay thế cho thông tin card </p>

<p>Token chứa những thông tin bí mật như mã số card, cvc có thể sử dụng như card</p>

<p>Có thể  sử  dụng khi đăng kí thông tin card cho khách hàng hay khi thực hiện xử lí chi trả</p>

<p>Token đã được sử  dụng 1 lần không thể dùng lại nữa nhưng nếu khách hàng đăng kí card thì bằng cách sử dụng customerID có thể thực hiện xử lí chi trả nhiều lần bằng cùng 1 card

<div name="トークンを作成" data-unique="トークンを作成"></div><h2 id="トークンを作成">Tạo token</h2>

<blockquote>
<p>POST https://api.pay.jp/v1/tokens</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/tokens <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036: <span class="se">\</span>
-d <span class="s2">"card[number]=4242424242424242"</span> <span class="se">\</span>
-d <span class="s2">"card[cvc]=123"</span> <span class="se">\</span>
-d <span class="s2">"card[exp_month]=02"</span> <span class="se">\</span>
-d <span class="s2">"card[exp_year]=2020"</span>
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Token</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">card</span><span class="o">=</span><span class="p">{</span>
        <span class="s">'number'</span> <span class="p">:</span> <span class="s">'4242424242424242'</span><span class="p">,</span>
        <span class="s">'cvc'</span> <span class="p">:</span> <span class="s">'123'</span><span class="p">,</span>
        <span class="s">'exp_month'</span> <span class="p">:</span> <span class="s">'2'</span><span class="p">,</span>
        <span class="s">'exp_year'</span> <span class="p">:</span> <span class="s">'2020'</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Token</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span>
  <span class="ss">:card</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="ss">:number</span> <span class="o">=&gt;</span> <span class="s1">'4242424242424242'</span><span class="p">,</span>
    <span class="ss">:cvc</span> <span class="o">=&gt;</span> <span class="s1">'123'</span><span class="p">,</span>
    <span class="ss">:exp_month</span> <span class="o">=&gt;</span> <span class="s1">'2'</span><span class="p">,</span>
    <span class="ss">:exp_year</span> <span class="o">=&gt;</span> <span class="s1">'2020'</span>
  <span class="p">}</span>
<span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
$card = array(
        "number" =&gt; "4242424242424242",
        "cvc" =&gt; "123",
        "exp_month" =&gt; "2",
        "exp_year" =&gt;"2020"
);
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="na">number</span><span class="p">:</span> <span class="mi">4242424242424242</span><span class="p">,</span>
  <span class="na">cvc</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
  <span class="na">exp_month</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="na">exp_year</span><span class="p">:</span> <span class="mi">2020</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">tokenParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">cardParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">cardParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"number"</span><span class="o">,</span> <span class="s">"4242424242424242"</span><span class="o">);</span>
<span class="n">cardParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"cvc"</span><span class="o">,</span> <span class="s">"123"</span><span class="o">);</span>
<span class="n">cardParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"exp_month"</span><span class="o">,</span> <span class="s">"2"</span><span class="o">);</span>
<span class="n">cardParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"exp_year"</span><span class="o">,</span> <span class="s">"2020"</span><span class="o">);</span>
<span class="n">tokenParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"card"</span><span class="o">,</span> <span class="n">cardParams</span><span class="o">);</span>
<span class="n">Token</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">tokenParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1442290383</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passed"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2020</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_e3ccd4e0959f45e7c75bacc4be90"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1442290383</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tok_5ca06b51685e001723a2c3b4aeb4"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"token"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"used"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"missing_param"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Missing required param to token."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card[exp_year]"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Chỉ định thông tin card, đăng kí token</p>

<p>Token có thể tạo bằng request từ server side nhưng thông thường sẽ sử dụng "checkout" và payjp.js thông qua browser chỉ định public key và thông tin card để tạo ra
Token không dùng được đến lần thứ 2</p>

<p>Về phương pháp implement token hóa sử dụng "Checkout" và payjp.js xem tại <a href="https://pay.jp/docs/cardtoken">Tutorial - Token hóa thông tin card</a></p>

<table><thead>
<tr>
<th>Tham số</th>
<th>Kiểu</th>
<th>Chi tiết</th>
</tr>
</thead><tbody>
<tr>
<td>card[number]</td>
<td>String</td>
<td><span class="required"><strong>Required</strong></span><br>Mã số card</td>
</tr>
<tr>
<td>card[exp_month]</td>
<td>String</td>
<td><span class="required"><strong>Required</strong></span><br>Tháng hết hạn</td>
</tr>
<tr>
<td>card[exp_year]</td>
<td>String</td>
<td><span class="required"><strong>Required</strong></span><br>Năm hết hạn</td>
</tr>
<tr>
<td>card[cvc]</td>
<td>String</td>
<td>CVC code (3~4 chữ số)</td>
</tr>
<tr>
<td>card[address_state]</td>
<td>String</td>
<td>Tỉnh</td>
</tr>
<tr>
<td>card[address_city]</td>
<td>String</td>
<td>Quận huyện</td>
</tr>
<tr>
<td>card[address_line1]</td>
<td>String</td>
<td>Số nhà (khu nhà)</td>
</tr>
<tr>
<td>card[address_line2]</td>
<td>String</td>
<td>Tên tòa nhà</td>
</tr>
<tr>
<td>card[address_zip]</td>
<td>String</td>
<td>Mã bưu điện</td>
</tr>
<tr>
<td>card[country]</td>
<td>String</td>
<td>ISO code (2 kí tự) (e.g. JP)</td>
</tr>
<tr>
<td>card[name]</td>
<td>String</td>
<td>Tên chủ thẻ (e.g. “YUI ARAGAKI”)</td>
</tr>
</tbody></table>

<div name="トークン情報を取得" data-unique="トークン情報を取得"></div><h2 id="トークン情報を取得">Thu thập thông tin token</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/tokens/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/tokens/tok_eff34b780cbebd61e87f09ecc9c6 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Token</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'tok_5ca06b51685e001723a2c3b4aeb4'</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Token</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'tok_5ca06b51685e001723a2c3b4aeb4'</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Token::retrieve("tok_5ca06b51685e001723a2c3b4aeb4");
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span><span class="s1">'tok_5ca06b51685e001723a2c3b4aeb4'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Token</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"tok_eff34b780cbebd61e87f09ecc9c6"</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1442290383</span><span class="p">,</span><span class="w">
    </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passed"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2020</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_e3ccd4e0959f45e7c75bacc4be90"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1442290383</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tok_5ca06b51685e001723a2c3b4aeb4"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"token"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"used"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no token with ID: dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Thu thập thông tin của 1 token</p>

<table><thead>
<tr>
<th>Tên thuộc tính</th>
<th>Kiểu</th>
<th>Chi tiết</th>
</tr>
</thead><tbody>
<tr>
<td>object</td>
<td>String</td>
<td>Tên object <em>Giá trị là "token"</em></td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>string hiển thị object bắt đầu bằng tok_</td>
</tr>
<tr>
<td>livemode</td>
<td>Boolean</td>
<td>có phải môi trường production hay không</td>
</tr>
<tr>
<td>created</td>
<td>Integer</td>
<td>UTC timestamp thời điểm tạo token</td>
</tr>
<tr>
<td>used</td>
<td>Boolean</td>
<td>token đã được sử dụng hay chưa</td>
</tr>
<tr>
<td>card</td>
<td>Dictionary</td>
<td>Thông tin credit card </td>
</tr>
<tr>
<td>card[object]</td>
<td>String</td>
<td>Tên object <em>giá trị là "card"</em></td>
</tr>
<tr>
<td>card[id]</td>
<td>String</td>
<td>string hiển thị object bắt đầu bằng car_</td>
</tr>
<tr>
<td>card[created]</td>
<td>Integer</td>
<td>UTC timestamp thời điểm tạo cardカ</td>
</tr>
<tr>
<td>card[name]</td>
<td>String</td>
<td>Tên chủ thẻ(e.g. YUI ARAGAKI)</td>
</tr>
<tr>
<td>card[last4]</td>
<td>String</td>
<td>4 kí tự cuối mã số thẻ </td>
</tr>
<tr>
<td>card[exp_month]</td>
<td>String</td>
<td>Tháng hết hạn</td>
</tr>
<tr>
<td>card[exp_year]</td>
<td>String</td>
<td>Năm hết hạn</td>
</tr>
<tr>
<td>card[brand]</td>
<td>String</td>
<td>Tên card brand</td>
</tr>
<tr>
<td>card[cvc_check]</td>
<td>String</td>
<td>Kết quả cvc check</td>
</tr>
<tr>
<td>card[fingerprint]</td>
<td>String</td>
<td>Key liên kết với mã credit card (để không trùng card)</td>
</tr>
<tr>
<td>card[address_city]</td>
<td>String</td>
<td>City</td>
</tr>
<tr>
<td>card[address_line1]</td>
<td>String</td>
<td>Số nhà (số khu)</td>
</tr>
<tr>
<td>card[address_line2]</td>
<td>String</td>
<td>Tòa nhà</td>
</tr>
<tr>
<td>card[address_state]</td>
<td>String</td>
<td>Tỉnh</td>
</tr>
<tr>
<td>card[country]</td>
<td>String</td>
<td>2 kí tự ISO code(e.g. JP)</td>
</tr>
<tr>
<td>card[address_zip]</td>
<td>String</td>
<td>Mã bưu điện</td>
</tr>
<tr>
<td>card[address_zip_check]</td>
<td>String</td>
<td>kết quả check mã bưu điện</td>
</tr>
</tbody></table>

          <div name="transfer-入金" data-unique="transfer-入金"></div><h1 id="transfer-入金">Transfer (入金)</h1>

<p>Kì hạn transfer là ngày 15 hàng tháng, tiền được transfer vào 15 và cuối tháng sau. Transfer sinh ra những data cho đến ngày transfer</p>

<div name="入金情報を取得" data-unique="入金情報を取得"></div><h2 id="入金情報を取得">Thu thập thông tin charge tiền</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/transfers/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/transfers/tr_8f0c0fe2c9f8a47f9d18f03959ba1 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Transfer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'tr_8f0c0fe2c9f8a47f9d18f03959ba1'</span><span class="p">)</span>

</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Transfer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'tr_8f0c0fe2c9f8a47f9d18f03959ba1'</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Transfer::retrieve("tr_8f0c0fe2c9f8a47f9d18f03959ba1");
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">transfers</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">(</span><span class="s1">'tr_8f0c0fe2c9f8a47f9d18f03959ba1'</span><span class="p">);</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Transfer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"tr_8f0c0fe2c9f8a47f9d18f03959ba1"</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
  </span><span class="nt">"carried_balance"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"charges"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
        </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"captured_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1441706750</span><span class="p">,</span><span class="w">
        </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1441706750</span><span class="p">,</span><span class="w">
          </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
          </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2018</span><span class="p">,</span><span class="w">
          </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_93e59e9a9714134ef639865e2b9e"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1441706750</span><span class="p">,</span><span class="w">
        </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_b92b879e60f62b532d6756ae12af"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ch_60baaf2dc8f3e35684ebe2031a6e0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"refund_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transfers/tr_8f0c0fe2c9f8a47f9d18f03959ba1/charges"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1438354800</span><span class="p">,</span><span class="w">
  </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tr_8f0c0fe2c9f8a47f9d18f03959ba1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"transfer"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"scheduled_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-09-16"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pending"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"charge_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"charge_fee"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"charge_gross"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="nt">"net"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="nt">"refund_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"refund_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"term_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1439650800</span><span class="p">,</span><span class="w">
  </span><span class="nt">"term_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1438354800</span><span class="p">,</span><span class="w">
  </span><span class="nt">"transfer_amount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"transfer_date"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Error response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no transfer with ID: dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Thu thập thông tin của 1 lần transfer</p>

<table><thead>
<tr>
<th>Tên thuộc tính</th>
<th>Kiểu</th>
<th>Chi tiết</th>
</tr>
</thead><tbody>
<tr>
<td>object</td>
<td>String</td>
<td>Tên object <em>Giá trị là "transfer"</em></td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>Chuỗi kí tự bắt đầu bằng tr_ biểu thị object</td>
</tr>
<tr>
<td>livemode</td>
<td>Boolean</td>
<td>Có phải môi trường production hay không</td>
</tr>
<tr>
<td>created</td>
<td>Integer</td>
<td>UTC timestamp tại thời điểm transfer tiền</td>
</tr>
<tr>
<td>amount</td>
<td>Integer</td>
<td>Số tiền dự định transfer</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>3 kí tự của code ISO(hiện chỉ support “jpy”)</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>Trạng thái của xử lí transfer tiền này</td>
</tr>
<tr>
<td>transfers</td>
<td>List</td>
<td>Danh sách chi trả trong lần transfer tiền này</td>
</tr>
<tr>
<td>scheduled_date</td>
<td>Date</td>
<td>Ngày dự định transfer tiền</td>
</tr>
<tr>
<td>summary</td>
<td>Dictionary</td>
<td>Thông tin thống kê liên quan đến lần transfer tiền này</td>
</tr>
<tr>
<td>summary[charge_count]</td>
<td>Integer</td>
<td>Tổng số lần chi trả</td>
</tr>
<tr>
<td>summary[charge_fee]</td>
<td>Integer</td>
<td>Tổng số phí thủ tục</td>
</tr>
<tr>
<td>summary[charge_gross]</td>
<td>Integer</td>
<td>Tổng số thu nhập (lợi nhuận)</td>
</tr>
<tr>
<td>summary[net]</td>
<td>Integer</td>
<td>Tổng số giảm trừ</td>
</tr>
<tr>
<td>summary[refund_amount]</td>
<td>Integer</td>
<td>Tổng số tiền trả lại</td>
</tr>
<tr>
<td>summary[refund_count]</td>
<td>Integer</td>
<td>Tổng số lần trả lại</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>Mô tả chung</td>
</tr>
<tr>
<td>term_start</td>
<td>Integer</td>
<td>UTC time stamp của thời điểm bắt đầu thống kê</td>
</tr>
<tr>
<td>term_end</td>
<td>Integer</td>
<td>UTC time stamp của thời điểm kết thúc thống kê</td>
</tr>
<tr>
<td>transfer_amount</td>
<td>Integer</td>
<td>Số tiền chuyển </td>
</tr>
<tr>
<td>transfer_date</td>
<td>Date</td>
<td>Ngày charge tiền</td>
</tr>
<tr>
<td>carried_balance</td>
<td>Integer</td>
<td>Carried balance</td>
</tr>
</tbody></table>

<div name="入金リストを取得" data-unique="入金リストを取得"></div><h2 id="入金リストを取得">Thu thập danh sách transfer</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/transfers</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/transfers?limit<span class="o">=</span>3 <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Transfer</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Transfer</span><span class="p">.</span><span class="nf">all</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Transfer::all();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">transfers</span><span class="p">.</span><span class="nx">list</span><span class="p">();</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Transfer</span><span class="o">.</span><span class="na">all</span><span class="o">();</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
      </span><span class="nt">"carried_balance"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"charges"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
            </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nt">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"captured_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1441706750</span><span class="p">,</span><span class="w">
            </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
              </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
              </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
              </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
              </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
              </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
              </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1441706750</span><span class="p">,</span><span class="w">
              </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
              </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
              </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2018</span><span class="p">,</span><span class="w">
              </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_93e59e9a9714134ef639865e2b9e"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
              </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1441706750</span><span class="p">,</span><span class="w">
            </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_b92b879e60f62b532d6756ae12af"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ch_60baaf2dc8f3e35684ebe2031a6e0"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nt">"refund_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="nt">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nt">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transfers/tr_8f0c0fe2c9f8a47f9d18f03959ba1/charges"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1438354800</span><span class="p">,</span><span class="w">
      </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tr_8f0c0fe2c9f8a47f9d18f03959ba1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"transfer"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"scheduled_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-09-16"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pending"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"charge_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"charge_fee"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"charge_gross"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
        </span><span class="nt">"net"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
        </span><span class="nt">"refund_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"refund_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"term_end"</span><span class="p">:</span><span class="w"> </span><span class="mi">1439650800</span><span class="p">,</span><span class="w">
      </span><span class="nt">"term_start"</span><span class="p">:</span><span class="w"> </span><span class="mi">1438354800</span><span class="p">,</span><span class="w">
      </span><span class="nt">"transfer_amount"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"transfer_date"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transfers"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid query string."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Thu thập danh sách transfer. Danh sách được lấy theo thừ tự thời điểm transfer được tạo ra từ mới cho đến cũ </p>

<table><thead>
<tr>
<th>Tham số</th>
<th>Kiểu</th>
<th>Chi tiết</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>Integer</td>
<td>1〜100</td>
</tr>
<tr>
<td>offset</td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>status (pending, paid, failed, canceled)</td>
</tr>
<tr>
<td>since</td>
<td>Integer</td>
<td>lấy những data được tạo ra từ time stamp này trở đi</td>
</tr>
<tr>
<td>until</td>
<td>Integer</td>
<td>lấy những data được tạo ra trước time stamp này</td>
</tr>
</tbody></table>

<div name="入金の内訳を取得" data-unique="入金の内訳を取得"></div><h2 id="入金の内訳を取得">Thu thập các mục khi transfer</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/transfers/:id/charges</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/transfers/tr_8f0c0fe2c9f8a47f9d18f03959ba1/charges <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">transfer</span> <span class="o">=</span> <span class="n">payjp</span><span class="o">.</span><span class="n">Transfer</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'tr_8f0c0fe2c9f8a47f9d18f03959ba1'</span><span class="p">)</span>
<span class="n">transfer</span><span class="o">.</span><span class="n">charges</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">transfer</span> <span class="o">=</span> <span class="no">Payjp</span><span class="o">::</span><span class="no">Transfer</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'tr_8f0c0fe2c9f8a47f9d18f03959ba1'</span><span class="p">)</span>
<span class="n">transfer</span><span class="p">.</span><span class="nf">charges</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="ss">limit: </span><span class="mi">3</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Transfer::retrieve("tr_8f0c0fe2c9f8a47f9d18f03959ba1")-&gt;charges-&gt;all(array("limit"=&gt;3));
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">transfers</span><span class="p">.</span><span class="nx">charges</span><span class="p">(</span><span class="s1">'tr_8f0c0fe2c9f8a47f9d18f03959ba1'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">limit</span><span class="p">:</span> <span class="mi">3</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Transfer</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">Transfer</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"tr_8f0c0fe2c9f8a47f9d18f03959ba1"</span><span class="o">);</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">listParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">listParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"limit"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
<span class="n">tr</span><span class="o">.</span><span class="na">getCharges</span><span class="o">.</span><span class="na">all</span><span class="o">(</span><span class="n">listParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>Response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
      </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"captured_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1441706750</span><span class="p">,</span><span class="w">
      </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1441706750</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_b92b879e60f62b532d6756ae12af"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2018</span><span class="p">,</span><span class="w">
        </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_93e59e9a9714134ef639865e2b9e"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1441706750</span><span class="p">,</span><span class="w">
      </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_b92b879e60f62b532d6756ae12af"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ch_60baaf2dc8f3e35684ebe2031a6e0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"refund_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/transfers/tr_8f0c0fe2c9f8a47f9d18f03959ba1/charges"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Error response</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_param_key"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid param key to transfer."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Thu thập các mục khi transfer. Danh sách được sắp xếp theo thời điểm tạo, từ mới đến cũ</p>

<table><thead>
<tr>
<th>Tham số</th>
<th>Kiểu</th>
<th>Chi tiết</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>Integer</td>
<td>1〜100</td>
</tr>
<tr>
<td>offset</td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td>customer</td>
<td>String</td>
<td>customer ID</td>
</tr>
<tr>
<td>since</td>
<td>Integer</td>
<td>Thu thập data từ time stamp được chỉ định trở đi</td>
</tr>
<tr>
<td>until</td>
<td>Integer</td>
<td>Thu thập data trước time stamp được chỉ định</td>
</tr>
</tbody></table>

          <div name="event-イベント" data-unique="event-イベント"></div><h1 id="event-イベント">Event (イベント)</h1>

<p>作成、更新、削除などのイベントを表示するオブジェクトです。イベント情報は、Webhookで任意のURLへ通知設定をすることができます。</p>

<div name="イベント情報を取得" data-unique="イベント情報を取得"></div><h2 id="イベント情報を取得">イベント情報を取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/events/:id</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/events/evnt_54db4d63c7886256acdbc784ccf <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Event</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s">'evnt_54db4d63c7886256acdbc784ccf'</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Event</span><span class="p">.</span><span class="nf">retrieve</span><span class="p">(</span><span class="s1">'evnt_54db4d63c7886256acdbc784ccf'</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Event::retrieve("evnt_54db4d63c7886256acdbc784ccf");
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Event</span><span class="o">.</span><span class="na">retrieve</span><span class="o">(</span><span class="s">"evnt_54db4d63c7886256acdbc784ccf"</span><span class="o">)</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1442288882</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"cards"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_a16c7b4df01168eb82557fe93de4/cards"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1441936720</span><span class="p">,</span><span class="w">
    </span><span class="nt">"default_card"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"updated\n"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cus_a16c7b4df01168eb82557fe93de4"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/customers/cus_a16c7b4df01168eb82557fe93de4/subscriptions"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"evnt_54db4d63c7886256acdbc784ccf"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"event"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"pending_webhooks"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"customer.updated"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"There is no event with ID: dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>特定のイベント情報を取得します。</p>

<table><thead>
<tr>
<th>プロパティ名</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>object</td>
<td>String</td>
<td>オブジェクト名 <em>値は"event"</em></td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>evnt_で始まる一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>livemode</td>
<td>Boolean</td>
<td>本番環境かどうか</td>
</tr>
<tr>
<td>created</td>
<td>Integer</td>
<td>このイベント作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>このイベントのタイプ</td>
</tr>
<tr>
<td>pending_webhooks</td>
<td>Integer</td>
<td>設定されたURLへの通知が完了していない(2xxのレスポンスが得られていない)webhookの数</td>
</tr>
<tr>
<td>data</td>
<td>Dictionary</td>
<td>このイベントに関連したデータ</td>
</tr>
</tbody></table>

<div name="イベントリストを取得" data-unique="イベントリストを取得"></div><h2 id="イベントリストを取得">イベントリストを取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/events</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl <span class="s1">'https://api.pay.jp/v1/events?limit=3&amp;offset=10'</span> <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Event</span><span class="o">.</span><span class="nb">all</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Event</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="ss">limit: </span><span class="mi">3</span><span class="p">,</span> <span class="ss">offset: </span><span class="mi">10</span><span class="p">)</span>
</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Event::all(array("limit"=&gt;3, "offset"=&gt;10));
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">listParams</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">listParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"limit"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
<span class="n">listParams</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"offset"</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="n">Event</span><span class="o">.</span><span class="na">all</span><span class="o">(</span><span class="n">listParams</span><span class="o">);</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1442298026</span><span class="p">,</span><span class="w">
      </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span><span class="w">
        </span><span class="nt">"amount_refunded"</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span><span class="w">
        </span><span class="nt">"captured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"captured_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1442212986</span><span class="p">,</span><span class="w">
        </span><span class="nt">"card"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unchecked"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1442212986</span><span class="p">,</span><span class="w">
          </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passed"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2016</span><span class="p">,</span><span class="w">
          </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car_f0984a6f68a730b7e1814ceabfe1"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"card"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1442212986</span><span class="p">,</span><span class="w">
        </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hogehoe"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"failure_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"failure_message"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ch_bcb7776459913c743c20e9f9351d4"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"charge"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"paid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"refund_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="nt">"refunded"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"evnt_8064917698aa417a3c86d292266"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"livemode"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"event"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"pending_webhooks"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"charge.updated"</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/events"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_param_key"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid param key to event."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>イベントリストを取得します。リストは、直近で生成された順番に取得されます。</p>

<table><thead>
<tr>
<th>引数</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>Integer</td>
<td>1〜100</td>
</tr>
<tr>
<td>offset</td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td>resource_id</td>
<td>String</td>
<td>取得するeventに紐づくAPIリソースのID (e.g. customer.id)</td>
</tr>
<tr>
<td>object</td>
<td>String</td>
<td>取得するeventに紐づくAPIリソースのobject<br>値はリソース名(e.g. customer, charge)</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>取得するeventのtype</td>
</tr>
<tr>
<td>since</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以降に作成されたデータを取得</td>
</tr>
<tr>
<td>until</td>
<td>Integer</td>
<td>ここに指定したタイムスタンプ以前に作成されたデータを取得</td>
</tr>
</tbody></table>

          <div name="account-アカウント" data-unique="account-アカウント"></div><h1 id="account-アカウント">Account (アカウント)</h1>

<p>あなたのアカウント情報です。</p>

<p>事業者用の <code class="prettyprint">merchant_account</code>、購入者用の <code class="prettyprint">customer_account</code> の2種類のアカウント情報を含んでいます。</p>

<div name="アカウント情報を取得" data-unique="アカウント情報を取得"></div><h2 id="アカウント情報を取得">アカウント情報を取得</h2>

<blockquote>
<p>GET https://api.pay.jp/v1/accounts</p>
</blockquote>
<pre class="highlight shell" style="display: none;"><code>curl https://api.pay.jp/v1/accounts <span class="se">\</span>
-u sk_test_c62fade9d045b54cd76d7036:
</code></pre>
<pre class="highlight python" style="display: none;"><code><span class="kn">import</span> <span class="nn">payjp</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="s">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="n">payjp</span><span class="o">.</span><span class="n">Account</span><span class="o">.</span><span class="n">retrieve</span><span class="p">()</span>
</code></pre>
<pre class="highlight ruby" style="display: block;"><code><span class="nb">require</span> <span class="s1">'payjp'</span>
<span class="no">Payjp</span><span class="p">.</span><span class="nf">api_key</span> <span class="o">=</span> <span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span>
<span class="no">Payjp</span><span class="o">::</span><span class="no">Account</span><span class="p">.</span><span class="nf">retrieve</span>

</code></pre>
<pre class="highlight php" style="display: none;"><code>\Payjp\Payjp::setApiKey("sk_test_c62fade9d045b54cd76d7036");
\Payjp\Account::retrieve();
</code></pre>
<pre class="highlight javascript" style="display: none;"><code><span class="kd">var</span> <span class="nx">payjp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'payjp'</span><span class="p">)(</span><span class="s1">'sk_test_c62fade9d045b54cd76d7036'</span><span class="p">);</span>
<span class="nx">payjp</span><span class="p">.</span><span class="nx">accounts</span><span class="p">.</span><span class="nx">retrieve</span><span class="p">();</span>
</code></pre>
<pre class="highlight java" style="display: none;"><code><span class="n">Payjp</span><span class="o">.</span><span class="na">apiKey</span> <span class="o">=</span> <span class="s">"sk_test_c62fade9d045b54cd76d7036"</span><span class="o">;</span>
<span class="n">Account</span><span class="o">.</span><span class="na">retrieve</span><span class="o">();</span>
</code></pre>

<blockquote>
<p>レスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1439706600</span><span class="p">,</span><span class="w">
  </span><span class="nt">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"赤坂"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7-4"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"203"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"港区"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1070050"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cards"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"address_city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"赤坂"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_line1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7-4"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_line2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"203"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"港区"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_zip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1070050"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"address_zip_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passed"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JP"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1458210534</span><span class="p">,</span><span class="w">
          </span><span class="nt">"cvc_check"</span><span class="p">:</span><span class="w"> </span><span class="s2">"passed"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
          </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2017</span><span class="p">,</span><span class="w">
          </span><span class="nt">"fingerprint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e1d8225886e3a7211127df751c86787f"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"acct_car_8089697ae44f3015087fa51"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4242"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test Hodler"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"updated"</span><span class="p">:</span><span class="w"> </span><span class="mi">1458210534</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nt">"has_more"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/accounts/cards"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JP"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1458210534</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"liveaccount@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Nanako"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"acct_cus_38153121efdb7964dd1e147"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Matsushima"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0312345678"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated"</span><span class="p">:</span><span class="w"> </span><span class="mi">1458210534</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"liveaccount@example.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"acct_8a27db83a7bf11a0c12b0c2833f"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"merchant"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"bank_enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brands_accepted"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"MasterCard"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"JCB"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"American Express"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"Diners Club"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"Discover"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"business_type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"charge_type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"contact_phone"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JP"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1439706600</span><span class="p">,</span><span class="w">
    </span><span class="nt">"currencies_supported"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"jpy"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"default_currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jpy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"details_submitted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"acct_mch_21a96cb898ceb6db0932983"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode_activated_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"livemode_enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"merchant"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"product_detail"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"product_name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"product_type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"site_published"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"object"</span><span class="p">:</span><span class="w"> </span><span class="s2">"account"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>エラーレスポンス</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid query string."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dummy"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client_error"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>あなたのアカウント情報を取得します。</p>

<table><thead>
<tr>
<th>プロパティ名</th>
<th>型</th>
<th>詳細</th>
</tr>
</thead><tbody>
<tr>
<td>object</td>
<td>String</td>
<td>オブジェクト名 <em>値は"account"</em></td>
</tr>
<tr>
<td>id</td>
<td>String</td>
<td>acct_で始まる一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>メールアドレス</td>
</tr>
<tr>
<td>created</td>
<td>Integer</td>
<td>このアカウント作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>customer</td>
<td>Dictionary</td>
<td>　カスタマーアカウントの詳細情報</td>
</tr>
<tr>
<td>customer[id]</td>
<td>String</td>
<td>acct_cus_で始まる一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>customer[address_state]</td>
<td>String</td>
<td>都道府県</td>
</tr>
<tr>
<td>customer[address_city]</td>
<td>String</td>
<td>市区町村</td>
</tr>
<tr>
<td>customer[address_line1]</td>
<td>String</td>
<td>番地など</td>
</tr>
<tr>
<td>customer[address_line2]</td>
<td>String</td>
<td>建物名など</td>
</tr>
<tr>
<td>customer[address_zip]</td>
<td>String</td>
<td>郵便番号</td>
</tr>
<tr>
<td>customer[cards]</td>
<td>List</td>
<td>カードのリスト</td>
</tr>
<tr>
<td>customer[country]</td>
<td>String</td>
<td>2桁のISOコード(e.g. JP)</td>
</tr>
<tr>
<td>customer[email]</td>
<td>String</td>
<td>メールアドレス</td>
</tr>
<tr>
<td>customer[phone]</td>
<td>String</td>
<td>電話番号</td>
</tr>
<tr>
<td>customer[first_name]</td>
<td>String</td>
<td>名</td>
</tr>
<tr>
<td>customer[last_name]</td>
<td>String</td>
<td>姓</td>
</tr>
<tr>
<td>customer[created]</td>
<td>Integer</td>
<td>カスタマーアカウント作成時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>customer[updated]</td>
<td>Integer</td>
<td>カスタマーアカウント最終更新時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>merchant</td>
<td>Dictionary</td>
<td>マーチャントアカウントの詳細情報</td>
</tr>
<tr>
<td>merchant[object]</td>
<td>String</td>
<td>オブジェクト名 <em>値は"merchant"</em></td>
</tr>
<tr>
<td>merchant[id]</td>
<td>String</td>
<td>acct_mch_で始まる一意なオブジェクトを示す文字列</td>
</tr>
<tr>
<td>merchant[bank_enabled]</td>
<td>Boolean</td>
<td>入金先銀行口座情報が設定済みかどうか</td>
</tr>
<tr>
<td>merchant[brands_accepted]</td>
<td>List</td>
<td>本番環境で利用可能なカードブランドのリスト</td>
</tr>
<tr>
<td>merchant[currencies_supported]</td>
<td>List</td>
<td>対応通貨のリスト</td>
</tr>
<tr>
<td>merchant[default_currency]</td>
<td>String</td>
<td>3文字のISOコード(現状 “jpy” のみサポート)</td>
</tr>
<tr>
<td>merchant[details_submitted]</td>
<td>Boolean</td>
<td>本番環境申請情報が提出済みかどうか</td>
</tr>
<tr>
<td>merchant[business_type]</td>
<td>String</td>
<td>業務形態</td>
</tr>
<tr>
<td>merchant[contact_phone]</td>
<td>String</td>
<td>電話番号</td>
</tr>
<tr>
<td>merchant[country]</td>
<td>String</td>
<td>所在国</td>
</tr>
<tr>
<td>merchant[charge_type]</td>
<td>List</td>
<td>支払い方法種別のリスト</td>
</tr>
<tr>
<td>merchant[product_detail]</td>
<td>String</td>
<td>販売商品の詳細</td>
</tr>
<tr>
<td>merchant[product_name]</td>
<td>String</td>
<td>販売商品名</td>
</tr>
<tr>
<td>merchant[product_type]</td>
<td>List</td>
<td>販売商品の種類リスト</td>
</tr>
<tr>
<td>merchant[livemode_enabled]</td>
<td>Boolean</td>
<td>本番環境が有効かどうか</td>
</tr>
<tr>
<td>merchant[livemode_activated_at]</td>
<td>Integer</td>
<td>本番環境が許可された日時のUTCタイムスタンプ</td>
</tr>
<tr>
<td>merchant[site_published]</td>
<td>Boolean</td>
<td>申請対象のサイトがオープン済みかどうか</td>
</tr>
<tr>
<td>merchant[url]</td>
<td>String</td>
<td>申請対象サイトのURL</td>
</tr>
<tr>
<td>merchant[created]</td>
<td>Integer</td>
<td>登録日時</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="https://pay.jp/docs/api/#" data-language-name="shell">curl</a>
                <a href="https://pay.jp/docs/api/#" data-language-name="python">Python</a>
                <a href="https://pay.jp/docs/api/#" data-language-name="ruby" class="active">Ruby</a>
                <a href="https://pay.jp/docs/api/#" data-language-name="php">PHP</a>
                <a href="https://pay.jp/docs/api/#" data-language-name="javascript">node</a>
                <a href="https://pay.jp/docs/api/#" data-language-name="java">Java</a>
          </div>
      </div>
    </div>


</body></html>
